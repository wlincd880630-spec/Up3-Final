<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dream Lab: Neural Link</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@500;700&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/microsoft-cognitiveservices-speech-sdk/distrib/browser/microsoft.cognitiveservices.speech.sdk.bundle-min.js"></script>
    
    <style>
        :root {
            /* 赛博配色 */
            --bg-deep: #020617;
            --panel-bg: rgba(15, 23, 42, 0.95);
            --neon-cyan: #22d3ee;
            --neon-pink: #fb7185;
            --neon-green: #34d399;
            --neon-amber: #fbbf24;
            
            /* 字体 */
            --font-tech: 'Orbitron', sans-serif;
            --font-body: 'Rajdhani', sans-serif;
            --font-cn: 'Noto Sans SC', sans-serif;
            
            --glow-text: 0 0 10px rgba(34, 211, 238, 0.5);
            --glow-border: 0 0 15px rgba(34, 211, 238, 0.3);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        /* === 核心修复：原生滚动布局 === */
        html, body {
            margin: 0; padding: 0;
            font-family: var(--font-body);
            background-color: var(--bg-deep);
            color: white;
            min-height: 100%;
            overflow-x: hidden; /* 仅隐藏横向滚动 */
            /* 移除 display: flex，回归文档流 */
        }

        body {
            padding-bottom: 80px; /* 底部导航留白 */
        }

        /* --- Home 按钮 (层级提高) --- */
        .home-btn {
            position: fixed; top: 15px; left: 15px; z-index: 9999;
            background: rgba(15, 23, 42, 0.9); color: var(--neon-cyan);
            padding: 8px 16px; border-radius: 4px; text-decoration: none;
            font-family: var(--font-tech); font-weight: 700; letter-spacing: 1px;
            border: 1px solid var(--neon-cyan); box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);
            backdrop-filter: blur(10px); display: flex; align-items: center; gap: 8px;
            text-transform: uppercase; font-size: 0.8rem; cursor: pointer;
        }

        /* --- 主终端容器 (自适应高度) --- */
        #terminal {
            width: 95vw; max-width: 1600px; 
            margin: 20px auto;
            min-height: 85vh; /* 最小高度 */
            height: auto;     /* 允许内容撑开 */
            
            background: var(--panel-bg);
            border: 2px solid rgba(255,255,255,0.1);
            border-top: 4px solid var(--neon-cyan);
            border-bottom: 4px solid var(--neon-cyan);
            border-radius: 12px;
            box-shadow: var(--glow-border), inset 0 0 100px rgba(0,0,0,0.8);
            position: relative; 
            backdrop-filter: blur(20px);
        }

        /* --- HUD 顶部 --- */
        .hud-top {
            height: 60px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex; align-items: center; justify-content: space-between; 
            padding: 0 20px;
            background: rgba(0,0,0,0.3);
            position: sticky; top: 0; z-index: 100;
        }
        .logo { 
            font-family: var(--font-tech); font-size: 1.5rem; color: var(--neon-cyan); 
            text-shadow: var(--glow-text); font-weight: 900; margin: 0 auto;
        }
        .progress-track { display: flex; gap: 4px; }
        .pip { 
            width: 20px; height: 6px; background: #334155; 
            transform: skewX(-20deg); cursor: pointer; transition: 0.3s; 
        }
        .pip.active { background: var(--neon-cyan); box-shadow: 0 0 10px var(--neon-cyan); }

        /* --- 屏幕内容 (改为相对定位) --- */
        .viewport { width: 100%; position: relative; }
        
        .screen {
            display: none; 
            width: 100%; 
            padding: 40px; 
            flex-direction: column; align-items: center;
            opacity: 0; transition: opacity 0.5s;
            animation: fadeIn 0.5s ease;
        }
        .screen.active { 
            display: flex; 
            opacity: 1; 
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- 通用组件 --- */
        .tech-card {
            background: rgba(30, 41, 59, 0.4); border: 1px solid rgba(255,255,255,0.1);
            border-left: 4px solid var(--neon-cyan); border-radius: 8px;
            padding: 20px; margin-bottom: 20px; width: 100%; box-sizing: border-box;
        }
        .label-tag {
            font-family: var(--font-tech); font-size: 0.9rem; color: var(--neon-pink);
            text-transform: uppercase; margin-bottom: 10px; display: block; letter-spacing: 1px;
            border-bottom: 1px solid rgba(244, 63, 94, 0.3); padding-bottom: 5px; width: fit-content;
        }
        
        /* 按钮 */
        .tech-btn {
            background: rgba(34, 211, 238, 0.1); border: 1px solid var(--neon-cyan); color: var(--neon-cyan);
            padding: 10px 20px; font-family: var(--font-tech); font-size: 1rem; font-weight: 700;
            cursor: pointer; text-transform: uppercase; letter-spacing: 1px; margin-top: 10px; 
            display: inline-flex; align-items: center; justify-content: center; gap: 8px;
            width: auto;
        }
        .btn-pink { border-color: var(--neon-pink); color: var(--neon-pink); background: rgba(244, 63, 94, 0.1); }

        /* 句子行 */
        .sentence-row { display: flex; justify-content: space-between; align-items: center; gap: 15px; margin-bottom: 10px; }
        .text-col { flex: 1; }
        .ctrl-col { display: flex; gap: 10px; align-items: center; min-width: 90px; justify-content: flex-end; }
        .cipher-text { color: white; font-size: 1.2rem; font-weight: 600; line-height: 1.4; }
        .cipher-text.hidden { filter: blur(6px); opacity: 0.5; user-select: none; }
        .cn-trans { color: #94a3b8; font-size: 1rem; margin-top: 5px; font-family: var(--font-cn); }

        .icon-btn { 
            cursor: pointer; font-size: 1.1rem; width: 40px; height: 40px; 
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2);
        }
        .tts-btn { color: var(--neon-amber); }
        .eye-btn { color: var(--neon-cyan); }

        /* 视频容器 (优化) */
        .vid-container-portrait {
            height: 350px; max-width: 100%; aspect-ratio: 9/16; margin: 20px auto;
            border: 2px solid var(--neon-cyan); border-radius: 8px; overflow: hidden; background: #000;
        }
        .vid-container-landscape {
            width: 100%; aspect-ratio: 16/9; border: 2px solid #334155; border-radius: 8px; background: #000; overflow: hidden;
        }
        video { width: 100%; height: 100%; object-fit: contain; display: block; }

        /* 布局容器 */
        .split-view { display: flex; width: 100%; gap: 20px; }
        .col-half { flex: 1; display: flex; flex-direction: column; }
        .flex-align-container { display: flex; width: 100%; gap: 20px; align-items: stretch; }
        .flex-col {
            flex: 1; display: flex; flex-direction: column;
            background: rgba(255,255,255,0.02); padding: 20px; border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* Mapping Boxes */
        .mapping-container { width: 100%; display: flex; flex-direction: column; align-items: center; margin-bottom: 15px; }
        .mapping-row { 
            display: flex; gap: 8px; margin: 15px 0; justify-content: center; width: 100%; 
            flex-wrap: wrap; 
        }
        .map-box {
            width: 50px; height: 70px; 
            border: 2px solid #334155; border-radius: 6px;
            display: flex; align-items: center; justify-content: center; 
            font-size: 1.8rem; color: var(--neon-cyan); font-weight: bold; cursor: pointer; 
            background: rgba(0,0,0,0.3); transition: 0.2s;
        }
        .map-box:hover { border-color: var(--neon-cyan); transform: translateY(-3px); }
        .map-box.revealed { background: rgba(34, 211, 238, 0.15); border-color: var(--neon-cyan); }
        .map-box span { visibility: hidden; } 
        .map-box.revealed span { visibility: visible; }
        .map-box.long { width: 90px; border-color: var(--neon-pink); color: var(--neon-pink); font-size: 1.4rem; }
        .map-box.long.revealed { background: rgba(244, 63, 94, 0.15); }

        /* Fusion 动画 */
        .fusion-chamber { 
            display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 20px; 
            font-family: var(--font-tech); font-size: 2.5rem; min-height: 120px; flex-wrap: wrap;
        }
        .atom { 
            padding: 15px 30px; border: 3px solid var(--neon-cyan); color: white; border-radius: 12px;
            background: #020617; position: relative; z-index: 2; transition: 0.8s;
        }
        .atom-suffix { border-color: var(--neon-pink); }
        .overload-flash {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 0; height: 0; border-radius: 50%; background: white; opacity: 0; pointer-events: none; z-index: 10;
        }
        @keyframes flashBang { 0% { width:0; opacity:1; } 100% { width:200vw; opacity:0; } }

        /* Profiles & Quiz */
        .profile-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%; }
        .profile-unit { 
            background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; 
            display: flex; align-items: flex-start; gap: 20px; border: 1px solid transparent; transition: 0.3s;
        }
        .profile-unit:hover { border-color: var(--neon-cyan); background: rgba(255,255,255,0.05); }
        .p-img-frame { 
            width: 100px; height: 100px; border-radius: 50%; overflow: hidden; 
            border: 2px solid #334155; flex-shrink: 0; box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
        .p-img { width: 100%; height: 100%; object-fit: cover; filter: blur(20px); transition: 1s; cursor: pointer; }
        .p-img.clear { filter: blur(0); }
        .p-info h4 { margin: 0 0 10px 0; font-family: var(--font-tech); font-size: 1.4rem; color: var(--neon-green); opacity: 0; transition: 0.5s; }
        .p-info p { margin: 0; font-size: 1rem; color: #cbd5e1; line-height: 1.5; }

        .quiz-card { background: rgba(255,255,255,0.05); padding: 15px; margin-bottom: 10px; border-radius: 8px; font-size: 1.1rem; }
        .q-input { 
            background: transparent; border: none; border-bottom: 2px solid var(--neon-cyan); 
            color: var(--neon-pink); font-size: 1.1rem; text-align: center; width: 120px; font-weight: bold;
        }

        /* --- 底部导航 --- */
        .nav-bot { 
            position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000;
            height: 70px; display: flex; align-items: center; justify-content: space-around;
            border-top: 1px solid rgba(255,255,255,0.1); background: rgba(2, 6, 23, 0.95);
            backdrop-filter: blur(10px);
        }
        .nav-btn {
            width: 50px; height: 50px; border-radius: 50%; background: rgba(255,255,255,0.05);
            border: 1px solid var(--neon-cyan); color: white; display: flex; align-items: center;
            justify-content: center; cursor: pointer; font-size: 1.2rem;
        }

        /* === 移动端深度适配 === */
        @media (max-width: 1024px) {
            #terminal { 
                width: 100%; margin: 0; border: none; border-radius: 0; min-height: 100vh;
            }
            .hud-top { 
                position: sticky; top: 0; z-index: 200; 
                background: rgba(2, 6, 23, 0.95); justify-content: center;
            }
            .progress-track { display: none; }
            
            /* 屏幕内容优化 */
            .screen { padding: 20px 15px 40px; }
            .split-view, .flex-align-container { flex-direction: column; gap: 30px; }
            .col-half, .flex-col { width: 100%; flex: none; }
            
            .mapping-row { gap: 5px; }
            .map-box { width: 40px; height: 55px; font-size: 1.4rem; } 
            .map-box.long { width: 70px; font-size: 1.1rem; }

            .profile-grid { grid-template-columns: 1fr; gap: 20px; }
            .profile-unit { flex-direction: row; text-align: left; }
            .p-img-frame { width: 80px; height: 80px; }
            .tech-btn { width: 100%; }
        }
    </style>
</head>
<body>

<a href="../../../index.html" class="home-btn"><i class="fas fa-home"></i> Home</a>

<div id="terminal">
    <div class="overload-flash" id="flash-effect"></div>

    <div class="hud-top">
        <div class="logo">DREAM LAB <span style="font-size:0.7rem; margin-left:5px; opacity:0.7; color:white;">MOBILE</span></div>
        <div class="progress-track" id="nav-track"></div>
    </div>

    <div class="viewport">
        
        <div class="screen active" id="p1">
            <div class="fusion-chamber">
                <div class="atom" id="atom-1">Imagine</div>
                <div style="color:#64748b;">+</div>
                <div class="atom atom-suffix" id="atom-2">-ation</div>
                <div id="final-word" style="display:none; color:var(--neon-green); text-shadow:0 0 30px var(--neon-green); font-size: 2.5rem; word-break:break-all;">IMAGINATION</div>
            </div>
            <button class="tech-btn" onclick="runFusion()" id="fuse-btn"><i class="fas fa-bolt"></i> Initialize Fusion</button>

            <div id="p1-content" style="width:100%; display:none; flex-direction:column; align-items:center; margin-top:30px;">
                <div class="tech-card" style="text-align:center; border-left-color:var(--neon-green);">
                    <p style="font-size:1.1rem; color:#cbd5e1;">Definition: To form a picture or idea in your mind.</p>
                    <button class="tech-btn" onclick="speak('To form a picture or idea in your mind.', this)"><i class="fas fa-volume-up"></i> Listen</button>
                </div>

                <div class="vid-container-portrait">
                    <video id="vid-imagine" src="Vid/imagine.mp4" playsinline controls 
                           onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\'color:white;text-align:center;padding:20px;\'>Video Not Found<br><small>Check Path: Vid/imagine.mp4</small></div>'">
                    </video>
                </div>

                <div class="tech-card" style="text-align:center;">
                    <h3 style="color:var(--neon-cyan); margin-top:0;">What is she imagining?</h3>
                    <div id="ans-1" style="display:none; animation:holoFadeIn 0.5s;">
                        <p style="font-size:1.2rem; font-weight:bold; color:white;">She is imagining the future.</p>
                        <button class="icon-btn tts-btn" style="margin: 10px auto;" onclick="speak('She is imagining the future.', this)"><i class="fas fa-volume-up"></i></button>
                    </div>
                    <button class="tech-btn btn-pink" onclick="document.getElementById('ans-1').style.display='block'; this.style.display='none'">Decrypt Answer</button>
                </div>

                <div style="width:100%; margin-top:20px;">
                    <h3 style="color:white; font-family:var(--font-tech); border-bottom:2px solid #334155; padding-bottom:10px;">Contextual Usage (Level B2)</h3>
                    
                    <div class="tech-card">
                        <span class="label-tag">1. Imagine somebody doing something</span>
                        <div class="sentence-row">
                            <div class="text-col">
                                <div class="cipher-text hidden" id="ex1-en">Can you <span style="color:var(--neon-cyan)">imagine him becoming</span> an astronaut?</div>
                                <div class="cn-trans">你能想象他成为一名宇航员吗？</div>
                            </div>
                            <div class="ctrl-col">
                                <div class="icon-btn tts-btn" onclick="speak('Can you imagine him becoming an astronaut?', this)"><i class="fas fa-volume-up"></i></div>
                                <div class="icon-btn eye-btn" onclick="toggleText('ex1-en')"><i class="fas fa-eye"></i></div>
                            </div>
                        </div>
                    </div>

                    <div class="tech-card">
                        <span class="label-tag">2. Imagine that</span>
                        <div class="sentence-row">
                            <div class="text-col">
                                <div class="cipher-text hidden" id="ex2-en">Scientists <span style="color:var(--neon-cyan)">imagine that</span> sea levels will rise if the ice melts.</div>
                                <div class="cn-trans">科学家推测如果冰川融化，海平面将上升。</div>
                            </div>
                            <div class="ctrl-col">
                                <div class="icon-btn tts-btn" onclick="speak('Scientists imagine that sea levels will rise if the ice melts.', this)"><i class="fas fa-volume-up"></i></div>
                                <div class="icon-btn eye-btn" onclick="toggleText('ex2-en')"><i class="fas fa-eye"></i></div>
                            </div>
                        </div>
                    </div>

                    <div class="tech-card">
                        <span class="label-tag">3. Imagine doing something</span>
                        <div class="sentence-row">
                            <div class="text-col">
                                <div class="cipher-text hidden" id="ex3-en"><span style="color:var(--neon-cyan)">Imagine living</span> in a world without smartphones!</div>
                                <div class="cn-trans">想象一下生活在一个没有智能手机的世界里！</div>
                            </div>
                            <div class="ctrl-col">
                                <div class="icon-btn tts-btn" onclick="speak('Imagine living in a world without smartphones!', this)"><i class="fas fa-volume-up"></i></div>
                                <div class="icon-btn eye-btn" onclick="toggleText('ex3-en')"><i class="fas fa-eye"></i></div>
                            </div>
                        </div>
                    </div>

                    <div class="tech-card">
                        <span class="label-tag">4. Imagine somebody to be</span>
                        <div class="sentence-row">
                            <div class="text-col">
                                <div class="cipher-text hidden" id="ex4-en">I <span style="color:var(--neon-cyan)">imagined high school to be</span> much harder.</div>
                                <div class="cn-trans">我原以为高中会比现在难得多。</div>
                            </div>
                            <div class="ctrl-col">
                                <div class="icon-btn tts-btn" onclick="speak('I imagined high school to be much harder.', this)"><i class="fas fa-volume-up"></i></div>
                                <div class="icon-btn eye-btn" onclick="toggleText('ex4-en')"><i class="fas fa-eye"></i></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="screen" id="p2">
            <div class="split-view">
                <div class="col-half">
                    <div class="vid-container-landscape">
                        <video id="vid-player" src="Vid/01.mp4" controls playsinline 
                               onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\'color:white;text-align:center;padding:20px;\'>Video Not Found<br><small>Check Path: Vid/01.mp4</small></div>'">
                        </video>
                    </div>
                    <div class="video-controls">
                        <button class="tech-btn" onclick="playClip('01.mp4')">Clip 01</button>
                        <button class="tech-btn" onclick="playClip('02.mp4')">Clip 02</button>
                        <button class="tech-btn" onclick="playClip('03.mp4')">Clip 03</button>
                    </div>
                    <div style="margin-top:20px; text-align:center;">
                        <button class="tech-btn btn-pink" onclick="document.getElementById('target-sent-box').style.display='block'; this.style.display='none'">Target Sentence</button>
                        <div id="target-sent-box" class="target-sentence-box" style="display:none; margin-top:20px;">
                            <div style="font-size:1.1rem; font-weight:bold; color:white; margin-bottom:10px;">I can't imagine what you have been through.</div>
                            <div style="color:#94a3b8; font-style:italic;">(Rephrase: I have no idea how hard your experience was.)</div>
                            <div class="icon-btn tts-btn" style="margin:10px auto;" onclick="speak('I can\'t imagine what you have been through.', this)"><i class="fas fa-volume-up"></i></div>
                        </div>
                    </div>
                </div>
                <div class="col-half">
                    <h3 style="font-family:var(--font-tech); color:var(--neon-green);">Context Scenarios</h3>
                    
                    <div class="tech-card">
                        <span class="label-tag">Scenario A: The Lost Puppy</span>
                        <p style="font-size:1rem; color:#cbd5e1; margin-bottom:15px;">Puppy Max was her family. Losing him felt like the sky falling down.</p>
                        <div class="sentence-row">
                            <div class="text-col">
                                <div class="cipher-text hidden" id="sc1-en">"I know he was family. <span style="color:var(--neon-pink)">I can't imagine what you've been through.</span>"</div>
                                <div class="cn-trans">我知道他是家人。我无法想象你经历了什么。</div>
                            </div>
                            <div class="ctrl-col">
                                <div class="icon-btn tts-btn" onclick="speak('I know he was family. I can\'t imagine what you\'ve been through.', this)"><i class="fas fa-volume-up"></i></div>
                                <div class="icon-btn eye-btn" onclick="toggleText('sc1-en')"><i class="fas fa-eye"></i></div>
                            </div>
                        </div>
                    </div>

                    <div class="tech-card">
                        <span class="label-tag">Scenario B: The Survivor</span>
                        <p style="font-size:1rem; color:#cbd5e1; margin-bottom:15px;">After the earthquake destroyed his home, he stood in silence.</p>
                        <div class="sentence-row">
                            <div class="text-col">
                                <div class="cipher-text hidden" id="sc2-en">"Looking at the ruins, <span style="color:var(--neon-pink)">I really can't imagine what he has been through.</span>"</div>
                                <div class="cn-trans">看着这些废墟，我真的无法想象他经历了什么。</div>
                            </div>
                            <div class="ctrl-col">
                                <div class="icon-btn tts-btn" onclick="speak('Looking at the ruins, I really can\'t imagine what he has been through.', this)"><i class="fas fa-volume-up"></i></div>
                                <div class="icon-btn eye-btn" onclick="toggleText('sc2-en')"><i class="fas fa-eye"></i></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="screen" id="p3">
            <div class="flex-align-container">
                <div class="flex-col">
                    <h2 style="font-family:var(--font-tech); color:var(--neon-cyan);">Mapping</h2>
                    <div class="mapping-container">
                        <div class="mapping-row">
                            <div class="map-box" onclick="revealMap(this, 'I')"><span>i</span></div>
                            <div class="map-box" onclick="revealMap(this, 'm')"><span>m</span></div>
                            <div class="map-box" onclick="revealMap(this, 'a')"><span>a</span></div>
                            <div class="map-box" onclick="revealMap(this, 'g')"><span>g</span></div>
                            <div class="map-box" onclick="revealMap(this, 'i')"><span>i</span></div>
                            <div class="map-box" onclick="revealMap(this, 'n')"><span>n</span></div>
                            <div class="map-box" onclick="revealMap(this, 'a')"><span>a</span></div>
                            <div class="map-box long" onclick="revealMap(this, 'tion')"><span>tion</span></div>
                        </div>
                        <button class="tech-btn" onclick="speak('Imagination', this)"><i class="fas fa-volume-up"></i> Read Word</button>
                    </div>
                    <div class="tech-card">
                        <span class="label-tag">Definition (Noun)</span>
                        <p style="font-size:1.2rem; line-height:1.6;">The ability to create pictures in your mind; the part of your mind that does this.</p>
                    </div>
                </div>

                <div class="flex-col">
                    <h2 style="font-family:var(--font-tech); color:var(--neon-amber);">Context Examples</h2>
                    <div class="tech-card">
                        <span class="label-tag">Example 1</span>
                        <div class="sentence-row">
                            <div class="text-col">
                                <div class="cipher-text hidden" id="imgn-ex1">She was <span style="color:var(--neon-cyan)">lost in imagination</span> during math class.</div>
                                <div class="cn-trans">她在数学课上陷入了遐想。</div>
                            </div>
                            <div class="ctrl-col">
                                <div class="icon-btn tts-btn" onclick="speak('She was lost in imagination during math class.', this)"><i class="fas fa-volume-up"></i></div>
                                <div class="icon-btn eye-btn" onclick="toggleText('imgn-ex1')"><i class="fas fa-eye"></i></div>
                            </div>
                        </div>
                    </div>
                    <div class="tech-card">
                        <span class="label-tag">Example 2</span>
                        <div class="sentence-row">
                            <div class="text-col">
                                <div class="cipher-text hidden" id="imgn-ex2">Sci-fi novels <span style="color:var(--neon-cyan)">turn on your imagination</span>.</div>
                                <div class="cn-trans">科幻小说会开启你的想象力。</div>
                            </div>
                            <div class="ctrl-col">
                                <div class="icon-btn tts-btn" onclick="speak('Sci-fi novels turn on your imagination.', this)"><i class="fas fa-volume-up"></i></div>
                                <div class="icon-btn eye-btn" onclick="toggleText('imgn-ex2')"><i class="fas fa-eye"></i></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="screen" id="p4">
            <h2 style="font-family:var(--font-tech); text-align:center;">Word Families</h2>
            <div class="flex-align-container">
                <div class="flex-col" style="border-color:var(--neon-pink);">
                    <div class="mapping-container">
                        <div class="mapping-row">
                            <div class="map-box" onclick="revealMap(this, 'i')"><span>i</span></div>
                            <div class="map-box" onclick="revealMap(this, 'm')"><span>m</span></div>
                            <div class="map-box" onclick="revealMap(this, 'a')"><span>a</span></div>
                            <div class="map-box" onclick="revealMap(this, 'g')"><span>g</span></div>
                            <div class="map-box" onclick="revealMap(this, 'i')"><span>i</span></div>
                            <div class="map-box" onclick="revealMap(this, 'n')"><span>n</span></div>
                            <div class="map-box long" onclick="revealMap(this, 'ary')"><span>ary</span></div>
                        </div>
                        <button class="tech-btn btn-pink" onclick="speak('Imaginary', this)">Read: Imaginary</button>
                    </div>
                    <div class="tech-card">
                        <span class="label-tag">Definition</span>
                        <p style="font-size:1.2rem;">Existing only in the mind; unreal.</p>
                    </div>
                    <div class="tech-card" style="margin-top:auto;">
                        <span class="label-tag">Common Words (-ary)</span>
                        <ul style="padding-left:20px; color:#cbd5e1; font-size:1rem; line-height:1.8;">
                            <li onclick="speak('Legendary', this)" style="cursor:pointer;"><i class="fas fa-play-circle"></i> Legendary (传奇的)</li>
                            <li onclick="speak('Necessary', this)" style="cursor:pointer;"><i class="fas fa-play-circle"></i> Necessary (必要的)</li>
                            <li onclick="speak('Ordinary', this)" style="cursor:pointer;"><i class="fas fa-play-circle"></i> Ordinary (普通的)</li>
                        </ul>
                    </div>
                </div>
                <div class="flex-col" style="border-color:var(--neon-green);">
                    <div class="mapping-container">
                        <div class="mapping-row">
                            <div class="map-box" onclick="revealMap(this, 'i')"><span>i</span></div>
                            <div class="map-box" onclick="revealMap(this, 'm')"><span>m</span></div>
                            <div class="map-box" onclick="revealMap(this, 'a')"><span>a</span></div>
                            <div class="map-box" onclick="revealMap(this, 'g')"><span>g</span></div>
                            <div class="map-box" onclick="revealMap(this, 'i')"><span>i</span></div>
                            <div class="map-box" onclick="revealMap(this, 'n')"><span>n</span></div>
                            <div class="map-box" onclick="revealMap(this, 'a')"><span>a</span></div>
                            <div class="map-box long" onclick="revealMap(this, 'tive')"><span>tive</span></div>
                        </div>
                        <button class="tech-btn" style="border-color:var(--neon-green); color:var(--neon-green);" onclick="speak('Imaginative', this)">Read: Imaginative</button>
                    </div>
                    <div class="tech-card">
                        <span class="label-tag">Definition</span>
                        <p style="font-size:1.2rem;">Having or showing creativity.</p>
                    </div>
                    <div class="tech-card" style="margin-top:auto;">
                        <span class="label-tag">Common Words (-tive)</span>
                        <ul style="padding-left:20px; color:#cbd5e1; font-size:1rem; line-height:1.8;">
                            <li onclick="speak('Creative', this)" style="cursor:pointer;"><i class="fas fa-play-circle"></i> Creative (有创造力的)</li>
                            <li onclick="speak('Active', this)" style="cursor:pointer;"><i class="fas fa-play-circle"></i> Active (活跃的)</li>
                            <li onclick="speak('Positive', this)" style="cursor:pointer;"><i class="fas fa-play-circle"></i> Positive (积极的)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="screen" id="p5">
            <h2 style="font-family:var(--font-tech); text-align:center;">Analysis</h2>
            <div class="split-view">
                <div class="col-half" style="align-items:center;">
                    <img src="img/avatar_poster.jpg" style="max-height:400px; width:auto; border-radius:8px;" onerror="this.src='https://placehold.co/300x400/000000/FFF?text=Movie+Poster'">
                </div>
                
                <div class="col-half">
                    <div class="tech-card">
                        <p style="font-size:1.4rem; margin-bottom:15px;">Q: Does the movie take place in the real world?</p>
                        <div id="ans-5" style="display:none; animation:holoFadeIn 0.5s;">
                            <p style="font-size:1.6rem;">No, the world of Pandora is <span id="swap-word" style="color:var(--neon-pink); font-weight:bold;">UNREAL</span>.</p>
                            <button class="tech-btn btn-pink" onclick="swapToImaginary()">Upgrade Vocabulary</button>
                        </div>
                        <button class="tech-btn" onclick="document.getElementById('ans-5').style.display='block'; this.style.display='none'">Reveal Answer</button>
                    </div>

                    <div id="p5-ex" style="opacity:0; transition:1s;">
                        <div class="tech-card">
                            <span class="label-tag">Definition (Eng-Eng)</span>
                            <p style="font-size:1.2rem; margin-bottom:20px;">Not real; produced by the imagination.</p>
                            
                            <div class="sentence-row">
                                <div class="text-col">
                                    <div class="cipher-text hidden" id="av-ex1">The movie portrays an <span style="color:var(--neon-pink)">imaginary world</span> filled with exotic creatures.</div>
                                    <div class="cn-trans">这部电影描绘了一个充满奇异生物的虚构世界。</div>
                                </div>
                                <div class="ctrl-col">
                                    <div class="icon-btn tts-btn" onclick="speak('The movie portrays an imaginary world filled with exotic creatures.', this)"><i class="fas fa-volume-up"></i></div>
                                    <div class="icon-btn eye-btn" onclick="toggleText('av-ex1')"><i class="fas fa-eye"></i></div>
                                </div>
                            </div>
                            
                            <hr style="border:0; border-top:1px dashed #334155; margin:10px 0;">

                            <div class="sentence-row">
                                <div class="text-col">
                                    <div class="cipher-text hidden" id="av-ex2">Many lonely children have <span style="color:var(--neon-pink)">imaginary friends</span> to talk to.</div>
                                    <div class="cn-trans">许多孤独的孩子会有假想的朋友。</div>
                                </div>
                                <div class="ctrl-col">
                                    <div class="icon-btn tts-btn" onclick="speak('Many lonely children have imaginary friends to talk to.', this)"><i class="fas fa-volume-up"></i></div>
                                    <div class="icon-btn eye-btn" onclick="toggleText('av-ex2')"><i class="fas fa-eye"></i></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="screen" id="p6">
            <h2 style="font-family:var(--font-tech); color:var(--neon-green); text-align:center;">Imaginative Minds</h2>
            
            <div class="profile-grid">
                <div class="profile-unit">
                    <div class="p-img-frame">
                        <img src="img/imaginative 01.jpg" class="p-img" onclick="revealProfile(this)" onerror="this.src='https://placehold.co/100?text=Einstein'">
                    </div>
                    <div class="p-info">
                        <h4>Albert Einstein</h4>
                        <p>A theoretical physicist who changed how we see the universe. He famously said, "Imagination is more important than knowledge."</p>
                    </div>
                </div>
                <div class="profile-unit">
                    <div class="p-img-frame">
                        <img src="img/imaginative 02.jpg" class="p-img" onclick="revealProfile(this)" onerror="this.src='https://placehold.co/100?text=Musk'">
                    </div>
                    <div class="p-info">
                        <h4>Elon Musk</h4>
                        <p>A visionary entrepreneur dreaming of Mars colonization. He revolutionized the electric car industry and space travel.</p>
                    </div>
                </div>
                <div class="profile-unit">
                    <div class="p-img-frame">
                        <img src="img/imaginative 03.jpg" class="p-img" onclick="revealProfile(this)" onerror="this.src='https://placehold.co/100?text=Rowling'">
                    </div>
                    <div class="p-info">
                        <h4>J.K. Rowling</h4>
                        <p>An author who conjured a magical world of wizards and muggles from a simple train ride idea.</p>
                    </div>
                </div>
                <div class="profile-unit">
                    <div class="p-img-frame">
                        <img src="img/imaginative 04.jpg" class="p-img" onclick="revealProfile(this)" onerror="this.src='https://placehold.co/100?text=Jobs'">
                    </div>
                    <div class="p-info">
                        <h4>Steve Jobs</h4>
                        <p>A tech pioneer who viewed technology as an art form. He changed how we interact with the world through design.</p>
                    </div>
                </div>
            </div>

            <div style="margin-top:30px; display:flex; gap:20px; flex-wrap:wrap; width:100%;">
                <div class="tech-card" style="flex:1;">
                    <div class="sentence-row">
                        <div class="text-col">
                            <div class="cipher-text hidden" id="ppl-ex1">J.K. Rowling is a highly <span style="color:var(--neon-green)">imaginative writer</span>.</div>
                            <div class="cn-trans">J.K.罗琳是一位极富想象力的作家。</div>
                        </div>
                        <div class="ctrl-col">
                            <div class="icon-btn tts-btn" onclick="speak('J.K. Rowling is a highly imaginative writer.', this)"><i class="fas fa-volume-up"></i></div>
                            <div class="icon-btn eye-btn" onclick="toggleText('ppl-ex1')"><i class="fas fa-eye"></i></div>
                        </div>
                    </div>
                </div>
                <div class="tech-card" style="flex:1;">
                    <div class="sentence-row">
                        <div class="text-col">
                            <div class="cipher-text hidden" id="ppl-ex2">Designers need to be <span style="color:var(--neon-green)">imaginative</span> to solve problems.</div>
                            <div class="cn-trans">设计师需要有想象力来解决问题。</div>
                        </div>
                        <div class="ctrl-col">
                            <div class="icon-btn tts-btn" onclick="speak('Designers need to be imaginative to solve problems.', this)"><i class="fas fa-volume-up"></i></div>
                            <div class="icon-btn eye-btn" onclick="toggleText('ppl-ex2')"><i class="fas fa-eye"></i></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="screen" id="p7">
            <h2 style="font-family:var(--font-tech); text-align:center; color:var(--neon-cyan);">Final Test</h2>
            <div class="flex-align-container">
                <div class="flex-col">
                    <h4 style="color:var(--neon-pink); font-family:var(--font-tech);">Part 1: Grammar (Imagine)</h4>
                    <div class="quiz-card">
                        1. Can you imagine <input type="text" class="q-input" data-ans="living"> (live) without the internet?
                    </div>
                    <div class="quiz-card">
                        2. I imagine <input type="text" class="q-input" data-ans="that"> he is very busy today.
                    </div>
                    <div class="quiz-card">
                        3. Imagine <input type="text" class="q-input" data-ans="winning"> (win) the first prize!
                    </div>
                    <div class="quiz-card">
                        4. She imagined the test <input type="text" class="q-input" data-ans="to be"> (be) difficult.
                    </div>
                </div>
                <div class="flex-col">
                    <h4 style="color:var(--neon-green); font-family:var(--font-tech);">Part 2: Word Choice</h4>
                    <div class="quiz-card">
                        5. The unicorn is an <input type="text" class="q-input" data-ans="imaginary"> (imaginary/imaginative) animal.
                    </div>
                    <div class="quiz-card">
                        6. The child is very <input type="text" class="q-input" data-ans="imaginative">; she turns boxes into castles.
                    </div>
                    <div class="quiz-card">
                        7. Reading books improves your <input type="text" class="q-input" data-ans="imagination"> (imagine/imagination).
                    </div>
                    <div class="quiz-card">
                        8. The story is completely <input type="text" class="q-input" data-ans="imaginary">; it never happened.
                    </div>
                </div>
            </div>
            <div style="text-align:center; margin-top:30px;">
                <button class="tech-btn" onclick="checkQuiz()">Submit Data</button>
                <div id="quiz-result" style="margin-top:20px; font-size:1.5rem; font-family:var(--font-tech);"></div>
            </div>
        </div>
    </div>

    <div class="nav-bot">
        <div class="nav-btn" onclick="navigate(-1)"><i class="fas fa-chevron-left"></i></div>
        <div style="color:var(--neon-cyan); font-family:var(--font-tech); letter-spacing:2px; font-size:0.8rem;">NAV</div>
        <div class="nav-btn" onclick="navigate(1)"><i class="fas fa-chevron-right"></i></div>
    </div>
</div>

<script>
    // --- Azure Speech Config ---
    const azureKey = "DKRXk8ueSfo5NdIOMqFRTCAfpeGDezJ3Snf5K8gGgtyqxiWdugLzJQQJ99BLACHYHv6XJ3w3AAAYACOGUYP9";
    const azureRegion = "eastus2"; 
    let synthesizer = null;
    let activeBtn = null;

    // Mobile Audio Wakeup
    async function wakeUpAudio() {
        try {
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            if (AudioContext) {
                const ctx = new AudioContext();
                await ctx.resume();
            }
        } catch (e) {
            console.warn("Audio Wakeup:", e);
        }
    }

    function speak(text, btnElement) {
        if (synthesizer) { try{synthesizer.close();}catch(e){} synthesizer=null; }
        if(activeBtn) activeBtn.classList.remove('playing');
        
        // Ensure audio context is ready on mobile
        wakeUpAudio();

        try {
            const speechConfig = SpeechSDK.SpeechConfig.fromSubscription(azureKey, azureRegion);
            speechConfig.speechSynthesisVoiceName = "en-US-AriaNeural"; 
            const audioConfig = SpeechSDK.AudioConfig.fromDefaultSpeakerOutput();
            synthesizer = new SpeechSDK.SpeechSynthesizer(speechConfig, audioConfig);
            if(btnElement) { activeBtn = btnElement; activeBtn.classList.add('playing'); }
            
            synthesizer.speakTextAsync(text, 
                res => { 
                    if(activeBtn) activeBtn.classList.remove('playing'); 
                    synthesizer.close(); 
                    synthesizer = null; 
                },
                err => {
                    console.error(err);
                    if(activeBtn) activeBtn.classList.remove('playing');
                }
            );
        } catch (e) { console.error(e); }
    }

    // --- Navigation Logic ---
    let currentScreen = 1;
    const totalScreens = 7;

    // 初始化：确保Home按钮和页面顶部对齐
    window.onload = function() {
        initNav();
        jumpTo(1);
    }
    
    function initNav() {
        const track = document.getElementById('nav-track');
        track.innerHTML = '';
        for(let i=1; i<=totalScreens; i++) {
            let pip = document.createElement('div');
            pip.className = `pip ${i===1?'active':''}`;
            pip.onclick = () => jumpTo(i);
            track.appendChild(pip);
        }
    }

    function navigate(dir) {
        let next = currentScreen + dir;
        if(next >= 1 && next <= totalScreens) jumpTo(next);
    }

    function jumpTo(page) {
        // Hide all screens
        for(let i=1; i<=totalScreens; i++) {
            document.getElementById(`p${i}`).classList.remove('active');
        }
        currentScreen = page;
        const nextScreen = document.getElementById(`p${currentScreen}`);
        nextScreen.classList.add('active');
        
        // Pips update
        const pips = document.querySelectorAll('.pip');
        pips.forEach(p => p.classList.remove('active'));
        if(pips[page-1]) pips[page-1].classList.add('active');
        
        // 手机端自动滚回顶部
        window.scrollTo(0,0);
    }

    function toggleText(id) {
        document.getElementById(id).classList.toggle('hidden');
    }

    // P1 Fusion
    function runFusion() {
        const btn = document.getElementById('fuse-btn');
        const flash = document.getElementById('flash-effect');
        const a1 = document.getElementById('atom-1');
        const a2 = document.getElementById('atom-2');
        
        a1.style.transform = 'translateX(30px) scale(0.8)';
        a2.style.transform = 'translateX(-30px) scale(0.8)';
        
        setTimeout(() => {
            flash.style.animation = "flashBang 0.6s ease-out";
            a1.style.opacity = 0; a2.style.opacity = 0;
            document.querySelector('.fusion-chamber div:nth-child(2)').style.opacity=0;

            setTimeout(() => {
                document.getElementById('final-word').style.display = 'block';
                document.getElementById('p1-content').style.display = 'flex';
                speak('Imagination');
                btn.style.display = 'none';
            }, 300);
        }, 600);
    }

    // Video Playback (Relative Path Fix)
    function playClip(src) {
        const v = document.getElementById('vid-player');
        // 相对路径修复：统一使用 Vid/ 目录
        v.src = 'Vid/' + src; 
        v.play().catch(e => alert("Video play failed. Check filename case sensitivity on GitHub."));
    }

    // Mapping
    function revealMap(el, text) {
        if(!el.classList.contains('revealed')) {
           el.classList.add('revealed');
           speak(text);
        }
    }

    // Swap Word
    function swapToImaginary() {
        const el = document.getElementById('swap-word');
        el.style.opacity = 0;
        setTimeout(() => {
            el.innerText = "IMAGINARY";
            el.style.color = "var(--neon-cyan)";
            el.style.opacity = 1;
            speak('Imaginary');
            const exSection = document.getElementById('p5-ex');
            exSection.style.opacity = 1;
        }, 300);
    }

    // Profile
    function revealProfile(img) {
        img.classList.add('clear');
        img.parentElement.nextElementSibling.querySelector('h4').style.opacity = '1';
        speak('Revealed');
    }

    // Quiz
    function checkQuiz() {
        const inputs = document.querySelectorAll('.q-input');
        let score = 0;
        inputs.forEach(inp => {
            if(inp.value.toLowerCase().trim() === inp.dataset.ans.toLowerCase()) {
                inp.style.borderBottomColor = 'var(--neon-green)';
                inp.style.color = 'var(--neon-green)';
                score++;
            } else {
                inp.style.borderBottomColor = 'red';
            }
        });
        const res = document.getElementById('quiz-result');
        res.innerText = `SCORE: ${score}/${inputs.length}`;
        res.style.color = score === inputs.length ? 'var(--neon-green)' : 'var(--neon-pink)';
    }
</script>
</body>
</html>