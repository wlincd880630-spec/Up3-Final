<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Unit 3 - Practice | Page 3</title>
    <script src="https://aka.ms/csspeech/jsbrowserpackageraw"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        /* --- 统一配色系统 (Aurora Theme) --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
            --nav-bg: rgba(255, 255, 255, 0.85);
            --card-bg: rgba(255, 255, 255, 0.95);
            --primary-color: #4a00e0;
            --secondary-color: #8e2de2;
            --accent-color: #ff6b6b;
            --text-dark: #2d3436;
            --text-light: #636e72;
            --correct-color: #2ecc71;
            --wrong-color: #e74c3c;
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-image: var(--bg-gradient);
            background-attachment: fixed;
            min-height: 100vh;
            color: var(--text-dark);
            display: flex;
            flex-direction: column;
        }

        /* --- 导航栏 --- */
        nav {
            background: var(--nav-bg);
            backdrop-filter: blur(10px);
            padding: 10px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .nav-links { display: flex; gap: 5px; flex-wrap: wrap; }

        .nav-btn {
            text-decoration: none;
            color: var(--text-light);
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .nav-btn:hover { background-color: rgba(142, 45, 226, 0.1); color: var(--primary-color); }
        .nav-btn.active {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: 0 4px 15px rgba(142, 45, 226, 0.4);
        }

        /* --- 分页切换器 --- */
        .part-nav { display: flex; justify-content: center; gap: 15px; margin: 30px 0 10px 0; }
        
        .part-btn {
            background: rgba(255,255,255,0.4); 
            border: 2px solid white; 
            color: white;
            padding: 10px 30px; 
            border-radius: 30px; 
            font-weight: 700; 
            cursor: pointer; 
            font-size: 1.1rem; 
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .part-btn:hover { background: rgba(255,255,255,0.6); transform: translateY(-2px); }
        
        .part-btn.active { 
            background: white; 
            color: var(--primary-color); 
            border-color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); 
        }

        /* --- 主内容区域 --- */
        .main-viewport { flex: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .content-card { 
            background: var(--card-bg); 
            border-radius: 24px; 
            width: 100%; max-width: 1000px; 
            min-height: 600px;
            padding: 40px; 
            box-sizing: border-box; 
            box-shadow: var(--shadow); 
            display: none; 
            animation: fadeIn 0.5s ease; 
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .content-card.active-card { display: block; }

        h2 { 
            color: var(--primary-color); 
            border-bottom: 2px solid rgba(142, 45, 226, 0.2); 
            padding-bottom: 15px; 
            margin-top: 0; 
            font-size: 2rem; 
            font-weight: 800; 
        }
        
        h3 { color: var(--secondary-color); margin-top: 30px; font-size: 1.4rem; }

        /* --- Part 1: Vocab Styles --- */
        .vocab-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        
        .vocab-card { 
            background: white; 
            border-radius: 16px; 
            padding: 20px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.05); 
            border-left: 5px solid var(--secondary-color); 
            transition: 0.3s;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        
        .vocab-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        .v-word { 
            font-size: 1.4rem; 
            font-weight: 800; 
            color: var(--primary-color); 
            margin-bottom: 10px; 
            display:flex; justify-content:space-between; align-items:center;
        }
        
        .v-sentence { 
            font-style: italic; 
            color: #555; 
            font-size: 1rem; 
            line-height: 1.5; 
            background: #f8f9fa; 
            padding: 12px; 
            border-radius: 8px; 
            flex-grow: 1;
        }
        
        /* --- General Inputs --- */
        .exercise-box { 
            background: #fff; 
            padding: 30px; 
            border-radius: 20px; 
            margin-bottom: 20px; 
            border-left: 6px solid var(--accent-color); 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .question-row { margin-bottom: 15px; line-height: 2; font-size: 1.15rem; }
        
        input[type="text"] {
            border: 2px solid #ddd; 
            border-radius: 8px; 
            padding: 6px 10px; 
            font-size: 1.1rem; 
            width: 140px; 
            text-align: center; 
            transition: 0.3s; 
            font-family: inherit;
            background: #fdfdfd;
        }
        
        input[type="text"]:focus { border-color: var(--secondary-color); outline: none; background: white; }
        input.correct { border-color: var(--correct-color); background-color: #e8f8f5; color: var(--correct-color); font-weight: bold;}
        input.wrong { border-color: var(--wrong-color); background-color: #fdedec; }

        .btn { 
            background: var(--primary-color); 
            color: white; 
            border: none; 
            padding: 12px 30px; 
            font-size: 1rem; 
            border-radius: 50px; 
            cursor: pointer; 
            transition: 0.2s; 
            font-weight: bold; 
            margin-top: 15px;
            box-shadow: 0 4px 10px rgba(74, 0, 224, 0.3);
        }
        
        .btn:hover { transform: translateY(-2px); background: var(--secondary-color); }
        
        .audio-btn {
            background: white;
            border: 2px solid var(--secondary-color);
            color: var(--secondary-color);
            width: 36px; height: 36px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.2s; flex-shrink: 0;
        }
        .audio-btn:hover { background: var(--secondary-color); color: white; }
        .audio-btn.playing { animation: pulse 1s infinite; background: var(--accent-color); border-color: var(--accent-color); color: white; }

        /* --- Part 2 Styles --- */
        .choice-container { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px; }
        
        .choice-item { 
            background: white; 
            border: 2px solid #eee; 
            padding: 10px 20px; 
            border-radius: 12px; 
            cursor: pointer; 
            transition: 0.2s; 
            font-weight: 500; 
            font-size: 1rem;
        }
        
        .choice-item:hover { border-color: var(--secondary-color); }
        .choice-item.selected { background: var(--secondary-color); color: white; border-color: var(--secondary-color); }
        .choice-item.correct-mark { background: var(--correct-color) !important; color: white !important; border-color: var(--correct-color); }
        .choice-item.wrong-mark { background: var(--wrong-color) !important; color: white !important; border-color: var(--wrong-color); opacity: 0.7; }
        
        .toggle-group { display: inline-flex; background: #eee; border-radius: 8px; padding: 4px; vertical-align: middle; margin: 0 5px;}
        .toggle-opt { padding: 4px 12px; cursor: pointer; border-radius: 6px; font-weight: 600; color: #666; transition: 0.2s; }
        .toggle-opt:hover { background: rgba(255,255,255,0.5); }
        .toggle-opt.selected { background: white; color: var(--primary-color); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .toggle-opt.correct-ans { background: var(--correct-color); color: white; }
        .toggle-opt.wrong-ans { background: var(--wrong-color); color: white; }

        /* --- Part 3: Mind Map --- */
        .mind-map-container { 
            position: relative; height: 500px; width: 100%; background: #f0f4f8; border-radius: 20px; margin-top: 20px;
            display: flex; justify-content: center; align-items: center; overflow: hidden;
        }
        
        .center-node {
            width: 140px; height: 140px; background: var(--secondary-color); color: white; border-radius: 50%; 
            display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 1.4rem;
            z-index: 2; box-shadow: 0 10px 25px rgba(142, 45, 226, 0.4); text-align: center;
        }
        
        .branch-node { position: absolute; display: flex; flex-direction: column; align-items: center; z-index: 2; }
        .branch-input { width: 110px !important; padding: 8px !important; border: 2px solid #ccc !important; border-radius: 10px !important; text-align: center; background: rgba(255,255,255,0.9) !important;}
        
        .hint-icon { 
            font-size: 1rem; cursor: help; margin-top: 5px; 
            background: #2d3436; color: white; border-radius: 50%; 
            width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; 
            transition: 0.2s; position: relative;
        }
        .hint-icon:hover { transform: scale(1.1); background: var(--accent-color); }
        
        .hint-tooltip { 
            display: none; position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: #2d3436; color: white; padding: 6px 10px; border-radius: 6px; 
            font-size: 0.85rem; width: 160px; text-align: center; z-index: 10; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); pointer-events: none;
        }
        .hint-icon:hover .hint-tooltip { display: block; }
        
        /* Positions */
        .pos-1 { top: 50px; left: 50%; transform: translateX(-50%); }
        .pos-2 { top: 120px; right: 15%; }
        .pos-3 { bottom: 120px; right: 15%; }
        .pos-4 { bottom: 50px; left: 50%; transform: translateX(-50%); }
        .pos-5 { bottom: 120px; left: 15%; }
        .pos-6 { top: 120px; left: 15%; }

        /* SVG Lines */
        .svg-lines { position: absolute; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        .svg-lines line { stroke: #cbd5e1; stroke-width: 3; }

        /* --- Part 3: Guided Qs --- */
        .guided-container { 
            min-height: 250px; display: flex; flex-direction: column; align-items: center; justify-content: center; 
            margin: 20px 0; background: #fff; border-radius: 20px; padding: 40px; 
            border: 2px dashed #dcdde1;
        }
        
        .guided-q { 
            font-size: 1.5rem; font-weight: bold; color: var(--primary-color); text-align: center; 
            animation: fadeIn 0.5s; display: none; width: 100%;
        }
        .guided-q.active { display: block; }
        
        .guided-next-btn { 
            margin-top: 30px; background: var(--secondary-color); color: white; border:none; 
            padding: 10px 40px; border-radius: 8px; cursor: pointer; font-size: 1.1rem; transition:0.3s;
        }
        .guided-next-btn:hover { background: var(--primary-color); transform: translateY(-2px); }

        .breathing-img { 
            animation: breathing 6s ease-in-out infinite; 
            width: 100%; border-radius: 15px; margin-bottom: 20px; 
            max-height: 400px; object-fit: cover;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        @keyframes breathing { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* 响应式 */
        @media (max-width: 900px) {
            .nav-brand span { display: none; }
            .content-card { padding: 20px; min-height: auto; }
            .vocab-grid { grid-template-columns: 1fr; }
            .mind-map-container { height: 600px; }
            .branch-node { position: relative; top: auto !important; left: auto !important; right: auto !important; bottom: auto !important; transform: none !important; margin: 10px 0; }
            .center-node { display: none; }
            .svg-lines { display: none; }
            .mind-map-container { flex-direction: column; height: auto; padding: 20px; }
        }
    </style>
</head>
<body>

    <nav>
        <a href="main page.html" class="nav-brand">
            <i class="fas fa-home"></i> <span>Unit 3</span>
        </a>
        <div class="nav-links">
            <a href="main page.html" class="nav-btn">Menu</a>
            <a href="page1.html" class="nav-btn">Page 1</a>
            <a href="page2.html" class="nav-btn">Page 2</a>
            <a href="page3.html" class="nav-btn active">Page 3</a>
            <a href="page4.html" class="nav-btn">Page 4</a>
        </div>
    </nav>

    <div class="part-nav">
        <button class="part-btn active" onclick="switchPart(1)" id="btn-p1">Part 1</button>
        <button class="part-btn" onclick="switchPart(2)" id="btn-p2">Part 2</button>
        <button class="part-btn" onclick="switchPart(3)" id="btn-p3">Part 3</button>
    </div>

    <div class="main-viewport">

        <div id="part1" class="content-card active-card">
            <h2>Part 1: Vocabulary Practice</h2>
            
            <div class="vocab-grid">
                <div class="vocab-card">
                    <div class="v-word">Go hiking <button class="audio-btn" onclick="playAudio('We plan to go hiking up the mountain trail. It is a long walk in nature that helps us exercise.', this)"><i class="fas fa-volume-up"></i></button></div>
                    <div class="v-sentence">"We plan to go hiking up the mountain trail. It is a long walk in nature that helps us exercise."</div>
                </div>
                <div class="vocab-card">
                    <div class="v-word">Low-cost <button class="audio-btn" onclick="playAudio('Camping is a low-cost way to travel. It is a cheap and affordable option compared to staying in expensive hotels.', this)"><i class="fas fa-volume-up"></i></button></div>
                    <div class="v-sentence">"Camping is a low-cost way to travel. It is a cheap and affordable option compared to staying in expensive hotels."</div>
                </div>
                <div class="vocab-card">
                    <div class="v-word">Across <button class="audio-btn" onclick="playAudio('We walked across the bridge to get to the other side. We started at one end and finished at the opposite end.', this)"><i class="fas fa-volume-up"></i></button></div>
                    <div class="v-sentence">"We walked across the bridge to get to the other side. We started at one end and finished at the opposite end."</div>
                </div>
                <div class="vocab-card">
                    <div class="v-word">Anywhere <button class="audio-btn" onclick="playAudio('You can find adventure anywhere you look. It can happen in a city, a forest, or even in your own backyard.', this)"><i class="fas fa-volume-up"></i></button></div>
                    <div class="v-sentence">"You can find adventure anywhere you look. It can happen in a city, a forest, or even in your own backyard."</div>
                </div>
                <div class="vocab-card">
                    <div class="v-word">Climb <button class="audio-btn" onclick="playAudio('It takes a lot of energy to climb to the top of the tower. We have to use our hands and feet to go up.', this)"><i class="fas fa-volume-up"></i></button></div>
                    <div class="v-sentence">"It takes a lot of energy to climb to the top of the tower. We have to use our hands and feet to go up."</div>
                </div>
                <div class="vocab-card">
                    <div class="v-word">Important <button class="audio-btn" onclick="playAudio('It is important to keep your passport safe. It is necessary and has great value for your travel.', this)"><i class="fas fa-volume-up"></i></button></div>
                    <div class="v-sentence">"It is important to keep your passport safe. It is necessary and has great value for your travel."</div>
                </div>
                <div class="vocab-card">
                    <div class="v-word">Map <button class="audio-btn" onclick="playAudio('You should take a map when exploring a new city. It is a drawing of the area that shows you where roads and places are located.', this)"><i class="fas fa-volume-up"></i></button></div>
                    <div class="v-sentence">"You should take a map when exploring a new city. It is a drawing of the area that shows you where roads and places are located."</div>
                </div>
            </div>

            <div class="exercise-box">
                <h3>Fill in the blanks:</h3>
                <div class="question-row">1. When you travel, it is <input type="text" data-ans="important"> to keep your passport in a safe place.</div>
                <div class="question-row">2. If you go to New York City, you can <input type="text" data-ans="climb"> 354 steps to the top of the Statue of Liberty.</div>
                <div class="question-row">3. You can have a fun adventure almost <input type="text" data-ans="anywhere">—in a foreign country, or even in your hometown.</div>
                <div class="question-row">4. Singapore is a very small country. You can walk <input type="text" data-ans="across"> it in one day.</div>
                <div class="question-row">5. When you go <input type="text" data-ans="hiking"> in a new place, you should take a <input type="text" data-ans="map"> with you.</div>
                <div class="question-row">6. If you want a(n) <input type="text" data-ans="low-cost"> vacation, go somewhere in your home country.</div>
                <button class="btn" onclick="checkInputs('part1')">Check Answers</button>
            </div>
        </div>

        <div id="part2" class="content-card">
            <h2>Part 2: What is a "Low-cost Vacation"?</h2>
            
            <div class="exercise-box">
                <h3>1. Local Exploration</h3>
                <p style="font-size: 1.2rem; line-height: 1.8;">
                    <span id="reading-p2">
                        A low-cost vacation means skipping <input type="text" id="ex-expensive" placeholder="adj."> (an adjective for a lot of money) flights/hotels and exploring nearby spots—like local parks, small towns, or free museums.
                    </span>
                    <button class="audio-btn" style="display:inline-flex; width:30px; height:30px; vertical-align:middle;" onclick="playAudio(document.getElementById('reading-p2').innerText, this)"><i class="fas fa-volume-up"></i></button>
                </p>
                <button class="btn" onclick="checkExpensive()">Check</button>
            </div>

            <div class="exercise-box">
                <h3>2. Budget Accommodation & Travel</h3>
                
                <p><strong>Q: Which places are good for a low-cost trip?</strong></p>
                <div class="choice-container" id="q-places">
                    <div class="choice-item wrong" onclick="toggleChoice(this)">Luxury hotels</div>
                    <div class="choice-item correct" onclick="toggleChoice(this)">Friends’ homes</div>
                    <div class="choice-item correct" onclick="toggleChoice(this)">Hostels</div>
                    <div class="choice-item correct" onclick="toggleChoice(this)">Airbnb shared rooms</div>
                    <div class="choice-item correct" onclick="toggleChoice(this)">Camping</div>
                </div>

                <p style="margin-top:20px;"><strong>Q: Which ways are good for a low-cost trip?</strong></p>
                <div class="choice-container" id="q-ways">
                    <div class="choice-item wrong" onclick="toggleChoice(this)">Group guided tours</div>
                    <div class="choice-item correct" onclick="toggleChoice(this)">Planning your own itinerary</div>
                    <div class="choice-item wrong" onclick="toggleChoice(this)">Gourmet dining</div>
                    <div class="choice-item wrong" onclick="toggleChoice(this)">Hiring a private guide</div>
                </div>
                
                <button class="btn" onclick="checkChoices()">Check Selections</button>
            </div>

            <div class="exercise-box">
                <h3>3. Off-Peak Getaways</h3>
                <p style="font-size: 1.2rem;">
                    A low-cost vacation is traveling during 
                    <span class="toggle-group">
                        <span class="toggle-opt" onclick="selectPeak(this, 'peak')">peak</span> / 
                        <span class="toggle-opt" onclick="selectPeak(this, 'non-peak')">non-peak</span>
                    </span>
                    seasons to get discounted flights.
                </p>
                <div id="peak-feedback" style="margin-top:10px; font-weight:bold;"></div>
            </div>
        </div>

        <div id="part3" class="content-card">
            <h2>Part 3: Adventure Anywhere</h2>
            <div style="text-align: center;">
                <img src="images/anywhere.jpg" class="breathing-img" alt="Adventure">
            </div>

            <div class="exercise-box">
                <h3>Brainstorm: What is "Adventure"?</h3>
                <p style="text-align:center;">Fill in the blanks. Hover over <span style="background:#2d3436; color:white; border-radius:50%; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; font-size:0.8rem;">?</span> for a definition hint.</p>
                
                <div class="mind-map-container">
                    <div class="center-node">Adventure</div>
                    
                    <svg class="svg-lines">
                        <line x1="50%" y1="50%" x2="50%" y2="15%" />
                        <line x1="50%" y1="50%" x2="85%" y2="30%" />
                        <line x1="50%" y1="50%" x2="85%" y2="70%" />
                        <line x1="50%" y1="50%" x2="50%" y2="85%" />
                        <line x1="50%" y1="50%" x2="15%" y2="70%" />
                        <line x1="50%" y1="50%" x2="15%" y2="30%" />
                    </svg>

                    <div class="branch-node pos-1">
                        <input type="text" class="branch-input" data-target="nature" placeholder="1. N_____">
                        <div class="hint-icon">?<div class="hint-tooltip">Hint: The physical world (mountains, trees, etc).</div></div>
                    </div>
                    
                    <div class="branch-node pos-2">
                        <input type="text" class="branch-input" data-target="explore" placeholder="2. E______">
                        <div class="hint-icon">?<div class="hint-tooltip">Hint: To travel through an unfamiliar area.</div></div>
                    </div>

                    <div class="branch-node pos-3">
                        <input type="text" class="branch-input" data-target="exciting" placeholder="3. E_______">
                        <div class="hint-icon">?<div class="hint-tooltip">Hint: Causing great enthusiasm.</div></div>
                    </div>

                    <div class="branch-node pos-4">
                        <input type="text" class="branch-input" data-target="trip" placeholder="4. T___">
                        <div class="hint-icon">?<div class="hint-tooltip">Hint: A journey or excursion.</div></div>
                    </div>

                    <div class="branch-node pos-5">
                        <input type="text" class="branch-input" data-target="risk" placeholder="5. R___">
                        <div class="hint-icon">?<div class="hint-tooltip">Hint: A situation involving danger.</div></div>
                    </div>

                    <div class="branch-node pos-6">
                        <input type="text" class="branch-input" data-target="brave" placeholder="6. B____">
                        <div class="hint-icon">?<div class="hint-tooltip">Hint: Ready to face danger.</div></div>
                    </div>
                </div>
                <div style="text-align:center; margin-top:20px;">
                    <button class="btn" onclick="checkMindMap()">Check Mind Map</button>
                </div>
            </div>

            <div class="exercise-box">
                <h3>Discussion: Micro-adventure</h3>
                <p style="text-align:center; color:#666;">Answer the questions to unlock the definition.</p>
                <div class="guided-container" id="guided-section">
                    <div class="guided-q active" id="gq1">Q1: Is a micro-adventure long or short? <br><button class="guided-next-btn" onclick="nextQ(1)">Next</button></div>
                    <div class="guided-q" id="gq2">Q2: Is a micro-adventure cheap or expensive? <br><button class="guided-next-btn" onclick="nextQ(2)">Next</button></div>
                    <div class="guided-q" id="gq3">Q3: Is a micro-adventure a local trip or trip abroad? <br><button class="guided-next-btn" onclick="nextQ(3)">Next</button></div>
                    <div class="guided-q" id="gq4">Q4: Do you need to take a long flight to a place far away? <br><button class="guided-next-btn" onclick="nextQ(4)">Next</button></div>
                    <div class="guided-q" id="gq5">Q5: Is a micro-adventure still fun, challenging and rewarding? <br><button class="guided-next-btn" onclick="nextQ(5)">Reveal Summary</button></div>
                </div>

                <div id="final-micro-task" style="display:none; animation: fadeIn 1s; font-size:1.2rem; line-height:2.2; text-align:center;">
                    <p>
                        A microadventure is an adventure that is 
                        <input type="text" class="flex-grp-1" style="width:100px;">, 
                        <input type="text" class="flex-grp-1" style="width:100px;"> and 
                        <input type="text" class="flex-grp-1" style="width:100px;"> 
                        <br>– yet still 
                        <input type="text" class="flex-grp-2" style="width:120px;">, 
                        <input type="text" class="flex-grp-2" style="width:120px;"> and 
                        <input type="text" class="flex-grp-2" style="width:120px;">. 
                        <br>It suggests you don't need to 
                        <input type="text" class="flex-grp-3"> 
                        to the other side of the world for the trip.
                    </p>
                    <button class="btn" onclick="checkMicroAnswers()">Check Summary</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- 1. Azure Speech SDK 配置 ---
        // 请在此填入您的 Azure Key 和 Region
        const azureKey = ""; 
        const azureRegion = ""; 
        
        let synthesizer;

        function initSpeechSDK() {
            if (typeof SpeechSDK !== 'undefined' && azureKey && azureRegion) {
                const speechConfig = SpeechSDK.SpeechConfig.fromSubscription(azureKey, azureRegion);
                speechConfig.speechSynthesisVoiceName = "en-US-JennyNeural"; 
                synthesizer = new SpeechSDK.SpeechSynthesizer(speechConfig);
            }
        }

        window.onload = function() {
            initSpeechSDK();
        };

        // 统一播放函数
        function playAudio(text, btnElement) {
            if(btnElement) btnElement.classList.add('playing');

            if (synthesizer) {
                synthesizer.speakTextAsync(
                    text,
                    result => {
                        if(btnElement) btnElement.classList.remove('playing');
                        synthesizer.close();
                        synthesizer = undefined;
                        initSpeechSDK(); // 重新初始化
                    },
                    error => {
                        console.log("Azure error, fallback");
                        browserSpeak(text, btnElement);
                    }
                );
            } else {
                browserSpeak(text, btnElement);
            }
        }

        function browserSpeak(text, btnElement) {
            window.speechSynthesis.cancel();
            const ut = new SpeechSynthesisUtterance(text);
            const voices = window.speechSynthesis.getVoices();
            ut.voice = voices.find(v => v.lang.includes('GB') || v.name.includes('UK') || v.lang.includes('US')) || null;
            ut.rate = 0.9;
            ut.onend = () => { if(btnElement) btnElement.classList.remove('playing'); };
            window.speechSynthesis.speak(ut);
        }

        // --- Switch Part ---
        function switchPart(n) {
            document.querySelectorAll('.content-card').forEach(el => el.classList.remove('active-card'));
            document.querySelectorAll('.part-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(`part${n}`).classList.add('active-card');
            document.getElementById(`btn-p${n}`).classList.add('active');
        }

        // --- Part 1 Checks ---
        function checkInputs(area) {
            const selector = area === 'part1' ? '#part1 input[data-ans]' : '';
            if(!selector) return;
            document.querySelectorAll(selector).forEach(inp => {
                if(inp.value.trim().toLowerCase() === inp.getAttribute('data-ans').toLowerCase()) {
                    inp.classList.add('correct'); inp.classList.remove('wrong');
                } else {
                    inp.classList.add('wrong'); inp.classList.remove('correct');
                }
            });
        }

        // --- Part 2 Checks ---
        function checkExpensive() {
            const inp = document.getElementById('ex-expensive');
            if(inp.value.trim().toLowerCase() === 'expensive') {
                inp.classList.add('correct'); inp.classList.remove('wrong');
            } else {
                inp.classList.add('wrong'); inp.classList.remove('correct');
            }
        }
        
        function toggleChoice(el) { el.classList.toggle('selected'); }
        
        function checkChoices() {
            document.querySelectorAll('.choice-item').forEach(item => {
                if(item.classList.contains('selected')) {
                    if(item.classList.contains('correct')) {
                        item.classList.add('correct-mark');
                        if(!item.innerText.includes('✅')) item.innerText += " ✅";
                    } else {
                        item.classList.add('wrong-mark');
                        if(!item.innerText.includes('❌')) item.innerText += " ❌";
                    }
                }
            });
        }

        function selectPeak(el, val) {
            el.parentElement.querySelectorAll('.toggle-opt').forEach(o => o.classList.remove('selected','correct-ans','wrong-ans'));
            el.classList.add('selected');
            const fb = document.getElementById('peak-feedback');
            if(val === 'non-peak') {
                el.classList.add('correct-ans');
                fb.innerHTML = "<span style='color:green'>Correct! ✅ Non-peak seasons offer better prices.</span>";
            } else {
                el.classList.add('wrong-ans');
                fb.innerHTML = "<span style='color:red'>Incorrect. ❌ Peak seasons are the most expensive.</span>";
            }
        }

        // --- Part 3 Mind Map ---
        function checkMindMap() {
            document.querySelectorAll('.branch-input').forEach(inp => {
                const target = inp.getAttribute('data-target');
                if(inp.value.trim().toLowerCase() === target) {
                    inp.classList.add('correct'); inp.classList.remove('wrong');
                } else {
                    inp.classList.add('wrong'); inp.classList.remove('correct');
                }
            });
        }

        // --- Part 3 Guided Questions ---
        function nextQ(currentId) {
            const current = document.getElementById(`gq${currentId}`);
            current.style.display = 'none'; // 先隐藏
            current.classList.remove('active');
            
            const next = document.getElementById(`gq${currentId+1}`);
            if(next) {
                next.style.display = 'block'; // 再显示
                setTimeout(() => next.classList.add('active'), 10); // 触发淡入动画
            } else {
                document.getElementById('final-micro-task').style.display = 'block';
                document.getElementById('guided-section').style.display = 'none';
            }
        }

        // --- Part 3 Smart Fill-in ---
        function checkMicroAnswers() {
            const g1Valid = ['short', 'simple', 'local', 'cheap', 'brief'];
            document.querySelectorAll('.flex-grp-1').forEach(inp => {
                const val = inp.value.trim().toLowerCase();
                if(g1Valid.includes(val)) { inp.classList.add('correct'); inp.classList.remove('wrong'); }
                else { inp.classList.add('wrong'); inp.classList.remove('correct'); }
            });

            const g2Valid = ['fun', 'exciting', 'challenging', 'refreshed', 'rewarding', 'interesting'];
            document.querySelectorAll('.flex-grp-2').forEach(inp => {
                const val = inp.value.trim().toLowerCase();
                if(g2Valid.includes(val)) { inp.classList.add('correct'); inp.classList.remove('wrong'); }
                else { inp.classList.add('wrong'); inp.classList.remove('correct'); }
            });

            const g3Valid = ['fly', 'travel', 'go'];
            document.querySelectorAll('.flex-grp-3').forEach(inp => {
                const val = inp.value.trim().toLowerCase();
                if(g3Valid.includes(val)) { inp.classList.add('correct'); inp.classList.remove('wrong'); }
                else { inp.classList.add('wrong'); inp.classList.remove('correct'); }
            });
        }

        // Init Voice List
        window.speechSynthesis.onvoiceschanged = function() { window.speechSynthesis.getVoices(); };
    </script>
</body>
</html>