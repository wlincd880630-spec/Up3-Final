<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page 04: Intensive Reading</title>
    <script src="https://cdn.jsdelivr.net/npm/microsoft-cognitiveservices-speech-sdk@latest/distrib/browser/microsoft.cognitiveservices.speech.sdk.bundle-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Nunito:wght@400;700&family=Playfair+Display:ital,wght@0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-red: #C8102E;
            --royal-blue: #003399;
            --gold: #D4AF37;
            --text-bg: #000000;
        }

        body, html { margin: 0; padding: 0; height: 100%; width: 100%; font-family: 'Nunito', sans-serif; overflow: hidden; background: #000; color: #fff; }

        .main-container { display: grid; grid-template-columns: 40% 60%; height: 100vh; }

        /* 左侧文章区 */
        .left-panel {
            background: var(--text-bg); padding: 40px; display: flex; flex-direction: column;
            border-right: 1px solid #333; overflow-y: auto;
        }
        .left-panel::-webkit-scrollbar { width: 6px; }
        .left-panel::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

        .lesson-title { 
            font-family: 'Bebas Neue', sans-serif; font-size: 2.5rem; color: var(--gold); margin-bottom: 30px; 
            border-bottom: 2px solid var(--primary-red); padding-bottom: 15px;
        }

        .para-block {
            margin-bottom: 30px; padding: 15px; border-left: 3px solid #333;
            transition: 0.3s;
        }
        .para-block:hover, .para-block.active { border-left-color: var(--gold); background: rgba(255,255,255,0.05); }

        .para-tools { margin-bottom: 10px; display: flex; gap: 10px; flex-wrap: wrap; }
        
        .tool-btn {
            background: #222; border: 1px solid #444; color: #ccc; 
            padding: 6px 15px; border-radius: 20px; cursor: pointer; font-size: 0.85rem;
            display: flex; align-items: center; gap: 6px; transition: 0.2s;
        }
        .tool-btn:hover { border-color: var(--gold); color: #fff; }
        .tool-btn.playing { background: var(--primary-red); color: #fff; border-color: var(--primary-red); }
        .tool-btn.analyze-btn { background: var(--royal-blue); color: #fff; border:none; }
        .tool-btn.analyze-btn:hover { background: var(--gold); color: #000; }

        .para-text {
            font-family: 'Playfair Display', serif; font-size: 1.15rem; line-height: 1.7; color: #ddd; text-align: justify; margin: 0;
        }

        /* 右侧互动区 */
        .right-panel {
            background: #1a1a1a; padding: 40px; overflow-y: auto; position: relative;
            background-image: radial-gradient(#222 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .right-panel::-webkit-scrollbar { width: 6px; }
        .right-panel::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }

        .interaction-card {
            background: rgba(30, 30, 30, 0.95); border: 1px solid #444; border-radius: 12px;
            padding: 30px; max-width: 800px; margin: 0 auto 50px auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            animation: slideUp 0.5s ease;
        }

        .card-title { color: var(--gold); font-size: 1.5rem; margin-bottom: 20px; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .instruction { color: #aaa; margin-bottom: 20px; font-style: italic; font-size: 1.1rem; line-height: 1.5; }

        /* Summary List */
        .summary-list { display: flex; flex-direction: column; gap: 15px; margin-bottom: 30px; }
        .summary-item { 
            background: #252525; padding: 20px; border-radius: 8px; border-left: 4px solid var(--royal-blue);
            cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden;
            display: flex; align-items: center; gap: 15px;
        }
        .summary-item:hover { background: #333; transform: translateX(5px); }
        
        .summary-index { font-size: 1.5rem; font-weight: bold; color: var(--gold); opacity: 0.5; min-width: 30px; text-align: center; }
        .summary-content-wrapper { flex: 1; display: flex; flex-direction: column; gap: 5px; }
        
        .summary-item-title, .summary-item-desc {
            color: var(--gold); font-weight: bold; filter: blur(8px); opacity: 0.6;
            transition: all 0.6s cubic-bezier(0.25, 1, 0.5, 1); user-select: none;
        }
        .summary-item-desc { color: #ddd; font-weight: normal; }
        
        .summary-item.revealed .summary-item-title, 
        .summary-item.revealed .summary-item-desc { filter: blur(0); opacity: 1; }
        .summary-item.revealed { border-left-color: #2ecc71; }
        .summary-item.revealed .click-hint { opacity: 0; }

        /* 输入框与按钮 */
        .input-group { margin-bottom: 25px; }
        .input-label { display: block; margin-bottom: 10px; font-weight: bold; color: #ddd; font-size: 1.1rem; }
        
        input[type="text"] {
            background: #333; border: 1px solid #555; color: #fff;
            padding: 12px; border-radius: 6px; width: 100%; font-size: 1rem;
            transition: 0.3s; box-sizing: border-box;
        }
        input:focus { border-color: var(--gold); outline: none; background: #444; }

        .checkbox-group { display: grid; grid-template-columns: 1fr; gap: 10px; }
        .checkbox-item {
            background: #2a2a2a; padding: 12px; border-radius: 6px; border: 1px solid #444;
            cursor: pointer; display: flex; align-items: center; justify-content: space-between;
            transition: 0.2s;
        }
        .checkbox-item:hover { border-color: #888; background: #333; }
        .checkbox-item.checked { border-color: var(--royal-blue); background: rgba(0, 51, 153, 0.1); }
        .icon-check { color: #2ecc71; display: none; }
        .checkbox-item.checked .icon-check { display: inline; }

        /* 表格 */
        .dynamic-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .dynamic-table th { background: var(--royal-blue); color: #fff; padding: 12px; text-align: left; border: 1px solid #555; }
        .dynamic-table td { border: 1px solid #555; padding: 10px; background: #222; }
        .dynamic-table input { background: transparent; border: none; border-bottom: 1px dashed #666; width: 100%; padding: 5px; }

        .action-btn {
            background: var(--gold); color: #000; border: none; padding: 12px 30px;
            font-size: 1rem; border-radius: 30px; cursor: pointer; font-weight: bold;
            margin-top: 20px; display: inline-flex; align-items: center; gap: 8px;
        }
        .action-btn:hover { transform: scale(1.05); background: #fff; }

        .critical-box {
            margin-top: 20px; padding: 20px; background: rgba(200, 16, 46, 0.1);
            border: 1px solid var(--primary-red); border-radius: 8px;
            animation: slideUp 0.5s ease;
        }
        .answer-reveal {
            margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.05);
            border-left: 3px solid var(--gold); display: none;
        }

        .final-comprehension-box {
            margin-top: 40px; border-top: 2px dashed #444; padding-top: 30px;
            display: none; animation: slideUp 0.6s ease;
        }

        /* 总结表格页面 (Overlay) */
        #final-summary-page {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #111; z-index: 2000; overflow-y: auto; padding: 40px;
            display: none; box-sizing: border-box;
        }
        .summary-table-view { width: 95%; margin: 60px auto 0 auto; max-width: 1200px; }
        
        /* 修复：Close 按钮改为 Fixed 定位 */
        .close-summary-btn { 
            position: fixed; /* 固定在窗口 */
            top: 30px; 
            right: 40px; 
            z-index: 2001; /* 确保在最上层 */
            background: var(--primary-red); 
            color: #fff; 
            border: none; 
            padding: 12px 25px; 
            cursor: pointer; 
            border-radius: 30px; 
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            transition: 0.3s;
        }
        .close-summary-btn:hover { background: #fff; color: #C8102E; transform: scale(1.05); }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <div class="main-container">
        <div class="left-panel">
            <div class="lesson-title">INTENSIVE READING</div>
            <div id="content-list"></div>
        </div>

        <div class="right-panel" id="interaction-panel">
            </div>
    </div>

    <div id="final-summary-page">
        <button class="close-summary-btn" onclick="document.getElementById('final-summary-page').style.display='none'">
            <i class="fas fa-times"></i> Close Summary
        </button>
        <div class="summary-table-view">
            <h1 style="color:var(--gold); text-align:center; margin-bottom:30px;">London Tour Summary</h1>
            <table class="dynamic-table" id="full-summary-table">
                <thead>
                    <tr>
                        <th>Place</th>
                        <th>Location</th>
                        <th>Features / Highlights</th>
                        <th>Practical Info</th>
                        <th>Fun Facts / Notes</th>
                    </tr>
                </thead>
                <tbody id="full-summary-body">
                    </tbody>
            </table>
            <div style="text-align:center; margin-top:40px;">
                <p style="font-size:1.2rem; color:#aaa;">Great job analyzing the text! You have successfully extracted all key information.</p>
            </div>
        </div>
    </div>

    <script>
        // --- 1. 数据配置 ---
        const summaryPoints = [
            { title: "Name", desc: "The official name of the attraction" },
            { title: "Location", desc: "Where it is or how to get there" },
            { title: "Features", desc: "The main highlights or activities (What to see/do)" },
            { title: "Practical Information", desc: "Prices, food, opening hours, etc." },
            { title: "Fun Facts", desc: "Interesting facts to engage the reader" }
        ];

        const paragraphs = [
            {
                id: 0, text: "London has been the setting for many popular movies—from James Bond to Harry Potter. So if you are visiting the UK’s capital, why not follow this walking tour and explore some interesting movie locations?",
                model: {
                    place: "London",
                    answers: { "Name": "London", "Fun Fact": "Setting for many popular movies (Bond, Potter)" }
                },
                isP1: true,
                specialQ: { q: "Why does the writer not introduce the location of London?", a: "Because London is a world-famous capital city." },
                finalReflect: { q: "Why does the writer choose the fun fact (movies) in the first paragraph?", a: "To catch the reader's interest immediately." },
                compQ: { q: "What is the main idea of this passage?", a: "It introduces the topic of a movie-themed walking tour in London." }
            },
            {
                id: 1, text: "Start at the London Film Museum. Here, you can see a collection of items from many famous movies. The museum is near Covent Garden—a famous market. And while you’re there, you should check out some of the amazing street performers.",
                model: { place: "London Film Museum", answers: { "Location": "Near Covent Garden", "What to see": "Movie items", "Fun Fact": "Near street performers" } },
                compQ: { q: "What can you do near the museum?", a: "Watch street performers at Covent Garden." }
            },
            {
                id: 2, text: "Next, walk down King Street, then along New Row to J. Sheekey. This restaurant is a great place to see TV and movie stars. And it’s not too expensive; you can get a great meal for under £25.",
                model: { place: "J. Sheekey", answers: { "Type": "Restaurant", "Feature": "See stars", "Price": "Under £25" } },
                compQ: { q: "Why is this restaurant popular?", a: "It's affordable and you might see celebrities." }
            },
            {
                id: 3, text: "Nearby is Leicester Square, known as London’s “Theatreland.” It is also home to the London Film Festival. Many famous movie premieres are held in this area of the city. One of the exits of the Leicester Square underground station appears in the movie Harry Potter.",
                model: { place: "Leicester Square", answers: { "Nickname": "Theatreland", "Event": "Film Festival", "Fun Fact": "Harry Potter location" } },
                compQ: { q: "What major event happens in Leicester Square?", a: "The London Film Festival and movie premieres." }
            },
            {
                id: 4, text: "To get away from the crowds, you should spend some time in Leicester Square Gardens. Here, you’ll see a statue of William Shakespeare. Shakespeare wrote his most famous plays while he was living in London.",
                model: { place: "Leicester Square Gardens", answers: { "Reason to visit": "Avoid crowds", "What to see": "Statue of William Shakespeare" } },
                compQ: { q: "Why is the Gardens a good place to visit?", a: "It is a quiet place away from the crowds." }
            },
            {
                id: 5, text: "From Leicester Square, walk down to Charing Cross Road and then to the National Gallery. Here, you can see famous paintings by artists like Vincent van Gogh and Leonardo da Vinci. This museum was also a location in the James Bond movie Skyfall.",
                model: { place: "The National Gallery", answers: { "Location": "Charing Cross Rd", "What to see": "Paintings", "Movie Link": "Skyfall" } },
                compQ: { q: "What famous movie was filmed here?", a: "James Bond: Skyfall." }
            },
            {
                id: 6, text: "Finally, go south on Charing Cross Road... At the end of the Mall, you’ll see Buckingham Palace, the home of the British royal family. The palace appears in several movies, such as The BFG and The King’s Speech.",
                model: { place: "Buckingham Palace", answers: { "Identity": "Royal Home", "Location": "End of Mall", "Movie Link": "The BFG, King's Speech" } },
                compQ: { q: "Who lives in Buckingham Palace?", a: "The British royal family." }
            }
        ];

        // --- 2. 初始化 ---
        function init() {
            initContentList();
            renderSummaryReview(); 
        }

        function initContentList() {
            const container = document.getElementById('content-list');
            paragraphs.forEach((p, index) => {
                const div = document.createElement('div');
                div.className = 'para-block';
                div.id = `para-${index}`;
                div.innerHTML = `
                    <div class="para-tools">
                        <button class="tool-btn" onclick="playByIndex(${index}, this)"><i class="fas fa-volume-up"></i> Play</button>
                        <button class="tool-btn analyze-btn" onclick="startAnalysis(${index})"><i class="fas fa-microscope"></i> Analyze</button>
                    </div>
                    <p class="para-text">${p.text}</p>
                `;
                container.appendChild(div);
            });
        }

        // --- 3. 模块 1: Summary Review (全模糊) ---
        function renderSummaryReview() {
            const panel = document.getElementById('interaction-panel');
            panel.innerHTML = '';
            const card = document.createElement('div');
            card.className = 'interaction-card';
            
            let itemsHtml = summaryPoints.map((p, i) => `
                <div class="summary-item" id="sum-item-${i}" onclick="revealItem(${i})">
                    <div class="summary-index">${i+1}</div>
                    <div class="summary-content-wrapper">
                        <span class="summary-item-title">${p.title}</span>
                        <span class="summary-item-desc">${p.desc}</span>
                    </div>
                    <i class="fas fa-hand-pointer click-hint"></i>
                </div>
            `).join('');

            card.innerHTML = `
                <div class="card-title">Summary of First Reading</div>
                <p class="instruction">In the first reading, we learnt that a tourist guide should include specific things.<br><strong>Click on the blurred items to reveal them:</strong></p>
                <div class="summary-list">${itemsHtml}</div>
                <div id="transition-msg" style="margin-top:30px; display:none; border-top:1px solid #444; padding-top:20px; text-align:center;">
                    <div style="color:var(--gold); font-size:1.1rem; margin-bottom:15px;">Excellent! We are going to use this logic to analyze the passage in detail.</div>
                    <button class="action-btn" onclick="startAnalysis(0)">Let's Read Paragraph 1 <i class="fas fa-arrow-right"></i></button>
                </div>
            `;
            panel.appendChild(card);
        }

        let revealedCount = 0;
        window.revealItem = function(index) {
            const el = document.getElementById(`sum-item-${index}`);
            if (!el.classList.contains('revealed')) {
                el.classList.add('revealed');
                revealedCount++;
                if (revealedCount === summaryPoints.length) {
                    const msg = document.getElementById('transition-msg');
                    msg.style.display = 'block';
                    anime({ targets: msg, opacity: [0, 1], translateY: [20, 0], duration: 800 });
                }
            }
        };

        // --- 4. 模块 2: Analysis Wizard ---
        window.startAnalysis = function(index) {
            document.querySelectorAll('.para-block').forEach(b => b.classList.remove('active'));
            document.getElementById(`para-${index}`).classList.add('active');

            const pData = paragraphs[index];
            const panel = document.getElementById('interaction-panel');
            panel.innerHTML = '';

            const card = document.createElement('div');
            card.className = 'interaction-card';
            card.innerHTML = `<div class="card-title">Analysis: Paragraph ${index + 1}</div>`;
            const contentArea = document.createElement('div');
            card.appendChild(contentArea);
            panel.appendChild(card);

            let wizState = { placeName: "", selectedCats: [] };

            // Step 1: Place Name
            function showStep1() {
                contentArea.innerHTML = `
                    <div class="step-indicator">Step 1: Identify Place</div>
                    <div class="input-group">
                        <label class="input-label">What place does this paragraph introduce to us?</label>
                        <input type="text" id="wiz-place" placeholder="Type place name here...">
                    </div>
                    <button class="action-btn" id="btn-s1">Next Step <i class="fas fa-arrow-right"></i></button>
                `;
                document.getElementById('btn-s1').onclick = () => {
                    const val = document.getElementById('wiz-place').value;
                    if(!val.trim()) return alert("Please enter the place name.");
                    wizState.placeName = val;
                    showStep2();
                };
            }

            // Step 2: Categorize
            function showStep2() {
                const cats = ["Name", "Location", "Features (What to see)", "Practical Info", "Fun Facts"];
                const checks = cats.map(c => `
                    <div class="checkbox-item" onclick="this.classList.toggle('checked')">
                        <span>${c}</span>
                        <div class="checkbox-icons"><i class="fas fa-check icon-check"></i></div>
                    </div>`).join('');

                contentArea.innerHTML = `
                    <div class="step-indicator">Step 2: Information Check</div>
                    <div class="input-label">Place: <span style="color:var(--gold)">${wizState.placeName}</span></div>
                    <div class="instruction">What information about this place does the passage tell us? (Select all that apply)</div>
                    <div class="checkbox-group" id="cat-group">${checks}</div>
                    <div id="p1-logic-area"></div>
                    <button class="action-btn" id="btn-s2">Next <i class="fas fa-arrow-right"></i></button>
                `;

                if (pData.isP1) {
                    const p1Area = document.getElementById('p1-logic-area');
                    const btn = document.getElementById('btn-s2');
                    btn.onclick = () => {
                        p1Area.innerHTML = `
                            <div class="critical-box">
                                <label class="input-label"><i class="fas fa-lightbulb"></i> Critical Thinking:</label>
                                <div class="instruction">${pData.specialQ.q}</div>
                                <button class="action-btn" style="background:#444;color:#fff;" onclick="document.getElementById('p1-ans').style.display='block'">Show Answer</button>
                                <div id="p1-ans" class="answer-reveal">${pData.specialQ.a}</div>
                            </div>
                        `;
                        btn.innerText = "Generate Table";
                        btn.onclick = () => { wizState.selectedCats = ["Name", "Fun Facts"]; showStep3(); };
                    };
                } else {
                    document.getElementById('btn-s2').onclick = () => {
                        wizState.selectedCats = Object.keys(pData.model.answers);
                        showStep3();
                    };
                }
            }

            // Step 3: Table + Final Question
            function showStep3() {
                const headers = wizState.selectedCats.map(c => `<th>${c}</th>`).join('');
                const inputs = wizState.selectedCats.map(() => `<td><input type="text" placeholder="..."></td>`).join('');

                let html = `
                    <div class="step-indicator">Step 3: Organize Information</div>
                    <h3 style="color:var(--gold); margin-top:0;">${wizState.placeName}</h3>
                    <table class="dynamic-table"><thead><tr>${headers}</tr></thead><tbody><tr>${inputs}</tr></tbody></table>
                    <button class="action-btn" id="btn-s3">Check Answers</button>
                    <div class="feedback-box" id="wiz-fb">
                        <h4>Model Answer:</h4>
                        <div id="model-content"></div>
                    </div>
                `;

                if (pData.isP1) {
                    html += `
                        <div id="p1-final-q" class="final-comprehension-box">
                            <label class="input-label">Reflection:</label>
                            <div class="instruction">${pData.finalReflect.q}</div>
                            <button class="action-btn secondary" onclick="document.getElementById('p1-reflect-ans').style.display='block'">Show Answer</button>
                            <div id="p1-reflect-ans" class="answer-reveal">${pData.finalReflect.a}</div>
                        </div>
                    `;
                }

                html += `
                    <div id="comp-q-area" class="final-comprehension-box" style="display:none;">
                        <label class="input-label" style="color:var(--gold); font-size:1.3rem;">Comprehension Check:</label>
                        <div class="instruction">${pData.compQ.q}</div>
                        <input type="text" placeholder="Type your understanding here..." style="margin-bottom:10px;">
                        <button class="action-btn" onclick="document.getElementById('comp-ans').style.display='block'">Check Understanding</button>
                        <div id="comp-ans" class="answer-reveal" style="background:rgba(52, 152, 219, 0.1); border-left-color:var(--royal-blue);">${pData.compQ.a}</div>
                        
                        ${index === paragraphs.length - 1 ? 
                          `<br><br><button class="action-btn" style="background:#27ae60; color:#fff; width:100%;" onclick="showFullSummaryTable()">Go to Final Summary Table <i class="fas fa-list-alt"></i></button>` 
                          : ''}
                    </div>
                `;

                contentArea.innerHTML = html;

                document.getElementById('btn-s3').onclick = () => {
                    const fb = document.getElementById('wiz-fb');
                    const mc = document.getElementById('model-content');
                    let ansHtml = `<ul>`;
                    for (const [k, v] of Object.entries(pData.model.answers)) ansHtml += `<li><strong>${k}:</strong> ${v}</li>`;
                    ansHtml += `</ul>`;
                    mc.innerHTML = ansHtml;
                    fb.style.display = 'block';

                    if(pData.isP1) {
                        document.getElementById('p1-final-q').style.display = 'block';
                        setTimeout(() => document.getElementById('comp-q-area').style.display = 'block', 1000);
                    } else {
                        document.getElementById('comp-q-area').style.display = 'block';
                    }
                };
            }
            showStep1();
        };

        // --- 5. 全篇总结表展示 ---
        window.showFullSummaryTable = function() {
            const tableBody = document.getElementById('full-summary-body');
            tableBody.innerHTML = ''; 
            const spots = paragraphs.filter(p => !p.isP1 && p.id > 0);
            spots.forEach(p => {
                const m = p.model.answers;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="color:var(--gold); font-weight:bold;">${p.model.place}</td>
                    <td>${m.Location || '-'}</td>
                    <td>${m["What to see"] || m.Feature || m.Event || '-'}</td>
                    <td>${m.Price || m["Reason to visit"] || '-'}</td>
                    <td>${m["Fun Fact"] || m["Movie Link"] || '-'}</td>
                `;
                tableBody.appendChild(row);
            });
            document.getElementById('final-summary-page').style.display = 'block';
        };

        // --- 6. TTS ---
        const speechConfig = { key: "DKRXk8ueSfo5NdIOMqFRTCAfpeGDezJ3Snf5K8gGgtyqxiWdugLzJQQJ99BLACHYHv6XJ3w3AAAYACOGUYP9", region: "eastus2", voice: "en-GB-RyanNeural" };
        let synthesizer; let currentPlayBtn = null;
        window.playByIndex = function(index, btn) {
            const text = paragraphs[index].text;
            if (synthesizer) { synthesizer.close(); synthesizer = undefined; }
            if (currentPlayBtn === btn) { resetBtnUI(btn); currentPlayBtn = null; return; }
            if (currentPlayBtn) resetBtnUI(currentPlayBtn);
            btn.classList.add('playing'); btn.innerHTML = '<i class="fas fa-stop"></i> Stop';
            currentPlayBtn = btn;
            const sdkConfig = SpeechSDK.SpeechConfig.fromSubscription(speechConfig.key, speechConfig.region);
            sdkConfig.speechSynthesisVoiceName = speechConfig.voice;
            const audioConfig = SpeechSDK.AudioConfig.fromDefaultSpeakerOutput();
            synthesizer = new SpeechSDK.SpeechSynthesizer(sdkConfig, audioConfig);
            synthesizer.speakTextAsync(text, 
                () => { resetBtnUI(btn); synthesizer.close(); currentPlayBtn = null; },
                err => { console.error(err); resetBtnUI(btn); synthesizer.close(); }
            );
        }
        function resetBtnUI(btn) { btn.classList.remove('playing'); btn.innerHTML = '<i class="fas fa-volume-up"></i> Play'; }
        init();
    </script>
</body>
</html>