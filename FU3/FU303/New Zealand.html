<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore: New Zealand (Pro V4)</title>
    
    <script src="https://cdn.staticfile.net/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.staticfile.net/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.staticfile.net/babel-standalone/7.22.17/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/microsoft-cognitiveservices-speech-sdk/distrib/browser/microsoft.cognitiveservices.speech.sdk.bundle-min.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&family=Fredoka:wght@500;600&family=Noto+Serif:ital,wght@0,500;1,500&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">

    <style>
        /* ÂÖ®Â±ÄËÆæÁΩÆ */
        * { -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: 'Outfit', sans-serif; 
            color: #f8fafc; 
            /* Ëï®Âè∂Áªø + ÂÜ∞Â∑ùËìùÊ∏êÂèò */
            background: linear-gradient(135deg, #064e3b, #065f46, #0c4a6e, #0f172a);
            background-size: 400% 400%;
            animation: kiwiFlow 25s ease infinite;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        @keyframes kiwiFlow { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        
        .serif { font-family: 'Noto Serif', serif; }
        .mono { font-family: 'Space Grotesk', monospace; }
        .fun-font { font-family: 'Fredoka', sans-serif; }

        /* ‰∏ªÂÆπÂô® */
        .app-container {
            width: 95vw;
            max-width: 1400px;
            height: 90vh;
            background: rgba(6, 95, 70, 0.85); /* Ê∑±ÁªøÂ∫ïËâ≤ */
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 32px;
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: row;
            overflow: hidden;
            position: relative;
        }
        
        /* ÁßªÂä®Á´ØÈÄÇÈÖç */
        @media (max-width: 768px) {
            .app-container { flex-direction: column; height: 100vh; width: 100vw; border-radius: 0; }
        }

        /* Âä®Áîª */
        .fade-in { animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* ÊªöÂä®Êù° */
        .custom-scroll { overflow-y: auto; scrollbar-width: thin; scrollbar-color: rgba(52, 211, 153, 0.3) transparent; }
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: rgba(52, 211, 153, 0.3); border-radius: 10px; }

        /* ÊªëÂùó */
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 28px; width: 28px; border-radius: 50%;
            background: #34d399; border: 4px solid white; cursor: pointer; margin-top: -12px;
            box-shadow: 0 0 15px rgba(52, 211, 153, 0.6); transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:active { transform: scale(1.2); }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 6px; cursor: pointer; 
            background: rgba(255,255,255,0.2); border-radius: 10px;
        }

        /* ÊôØÁÇπÈÄâÊã©ÊåâÈíÆ */
        .loc-btn {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
            color: #d1fae5; border-radius: 12px; padding: 10px; font-weight: 700; font-size: 0.9rem;
            transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;
            cursor: pointer;
        }
        .loc-btn:hover { background: rgba(255,255,255,0.2); color: white; }
        .loc-btn.active { background: #10b981; color: white; border-color: #34d399; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4); transform: scale(1.02); }

        /* ËøîÂõûÊåâÈíÆ */
        .nav-back { 
            position: absolute; top: 24px; left: 24px; z-index: 50; 
            background: rgba(0,0,0,0.6); color: white; 
            padding: 10px 20px; border-radius: 99px; text-decoration: none; 
            backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.2); 
            font-weight: 600; font-size: 1rem;
            transition: all 0.2s; display: flex; align-items: center; gap: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .nav-back:hover { background: rgba(0,0,0,0.8); transform: scale(1.05); }
    </style>
</head>
<body>
    
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // üîπ Azure ËØ≠Èü≥ÈÖçÁΩÆ
        // ==========================================
        const azureKey = "DKRXk8ueSfo5NdIOMqFRTCAfpeGDezJ3Snf5K8gGgtyqxiWdugLzJQQJ99BLACHYHv6XJ3w3AAAYACOGUYP9";
        const azureRegion = "eastus2"; 
        
        let currentSynthesizer = null;

        const speak = (text, onComplete) => {
            if (currentSynthesizer) { currentSynthesizer.close(); currentSynthesizer = null; }
            if (!text) { if(onComplete) onComplete(); return; }
            
            try {
                const speechConfig = SpeechSDK.SpeechConfig.fromSubscription(azureKey, azureRegion);
                speechConfig.speechSynthesisVoiceName = "en-NZ-MitchellNeural"; 
                const audioConfig = SpeechSDK.AudioConfig.fromDefaultSpeakerOutput();
                const synthesizer = new SpeechSDK.SpeechSynthesizer(speechConfig, audioConfig);
                currentSynthesizer = synthesizer;
                
                synthesizer.speakTextAsync(text, result => {
                    synthesizer.close(); currentSynthesizer = null;
                    if(onComplete) onComplete();
                }, err => { console.error(err); synthesizer.close(); currentSynthesizer = null; if(onComplete) onComplete(); });
            } catch (e) { console.error("Azure Error", e); if(onComplete) onComplete(); }
        };

        // ==========================================
        // üîπ Êï∞ÊçÆÈÖçÁΩÆ (Â§öÊôØÁÇπ)
        // ==========================================
        const LOCATIONS = [
            {
                id: 'milford',
                title: "Milford Sound",
                icon: "ph-mountains",
                imgs: ["milford_sound.jpg", "milford_sound 02.jpg", "milford_sound 03.jpg"],
                desc_en: "Described by Rudyard Kipling as the 'eighth wonder of the world', Milford Sound is a fjord known for its towering Mitre Peak, rainforests, and waterfalls.",
                desc_cn: "Á±≥Â∞îÁ¶èÂæ∑Â≥°ÊπæË¢´Ë™â‰∏∫‚Äú‰∏ñÁïåÁ¨¨ÂÖ´Â§ßÂ•áËøπ‚ÄùÔºå‰ª•È´òËÄ∏ÁöÑÊïôÂÜ†Â≥∞„ÄÅËåÇÂØÜÁöÑÈõ®Êûó‰ª•ÂèäÂ£ÆËßÇÁöÑÈ£ûÁÄëËÄåÈóªÂêç„ÄÇ"
            },
            {
                id: 'hobbiton',
                title: "Hobbiton",
                icon: "ph-house-line",
                imgs: ["hobbiton.jpg", "hobbiton_01.jpg", "hobbiton_02.jpg"],
                desc_en: "Situated in Matamata, the Hobbiton Movie Set is a famous location from The Lord of the Rings. It features colorful Hobbit holes built into the rolling green hills.",
                desc_cn: "ÈúçÊØîÂ±Ø‰Ωç‰∫éÁéõÂ°îÁéõÂ°îÔºåÊòØ„ÄäÊåáÁéØÁéã„ÄãËëóÂêçÁöÑÁîµÂΩ±ÂèñÊôØÂú∞„ÄÇËøôÈáåÊúâÂª∫Âú®ËøûÁªµËµ∑‰ºèÁöÑÁªøËâ≤Â±±‰∏ò‰∏äÁöÑËâ≤ÂΩ©ÊñëÊñìÁöÑÈúçÊØîÁâπ‰∫∫Ê¥ûÁ©¥„ÄÇ"
            }
        ];

        const COMMON_INFO = {
            country: "New Zealand",
            fun_title: "Did You Know?",
            fun_en: "New Zealand has more sheep than people (about 5 sheep for every person)! It is also the home of the 'Kiwi', a cute flightless bird that is a national symbol.",
            fun_cn: "Êñ∞Ë•øÂÖ∞ÁöÑÁæäÊØî‰∫∫ËøòÂ§öÔºàÂπ≥ÂùáÊØè‰∫∫Êã•ÊúâÁ∫¶5Âè™ÁæäÔºâÔºÅËøôÈáå‰πüÊòØ‚ÄúÂ•áÂºÇÈ∏ü‚ÄùÁöÑÂÆ∂‰π°ÔºåËøôÁßç‰∏ç‰ºöÈ£ûÁöÑÂèØÁà±È∏üÁ±ªÊòØÊñ∞Ë•øÂÖ∞ÁöÑÂõΩÂÆ∂Ë±°ÂæÅ„ÄÇ",
            intro: "Kia Ora! Let's explore Middle-earth."
        };

        // ==========================================
        // üîπ ÁªÑ‰ª∂Âå∫Âüü
        // ==========================================

        const App = () => {
            const [activeId, setActiveId] = useState('milford');
            const [view, setView] = useState('focus'); // focus | learn
            const [focusVal, setFocusVal] = useState(0);
            const [imgIdx, setImgIdx] = useState(0); 
            
            const activeLoc = LOCATIONS.find(l => l.id === activeId);

            useEffect(() => { setTimeout(() => speak(COMMON_INFO.intro), 800); }, []);

            // ÂàáÊç¢Âú∞ÁÇπ
            const switchLocation = (id) => {
                setActiveId(id);
                setImgIdx(0);
                setFocusVal(0);
                setView('focus'); // ÈáçÁΩÆÂõûÂØπÁÑ¶Èò∂ÊÆµ
                speak(`Let's go to ${LOCATIONS.find(l=>l.id===id).title}. Adjust focus.`);
            };

            const handleFocusComplete = () => {
                speak(`Beautiful! This is ${activeLoc.title}.`, () => {
                    setTimeout(() => setView('learn'), 1000);
                });
            };

            const changeImage = (dir) => {
                const total = activeLoc.imgs.length;
                let next = imgIdx + dir;
                if (next >= total) next = 0;
                if (next < 0) next = total - 1;
                setImgIdx(next);
            };

            const blurAmount = Math.max(0, 20 - (focusVal / 5));

            return (
                <div className="app-container fade-in">
                    
                    {/* 1. Â∑¶‰æßÔºöÁõ∏Êú∫ÂèñÊôØÂô® */}
                    <div className="flex-1 md:flex-[1.8] relative bg-black overflow-hidden border-b-4 md:border-b-0 md:border-r-4 border-green-900/50 group h-[40vh] md:h-auto">
                        <a href="FU303Main.html" className="nav-back">
                            <i className="ph ph-arrow-u-up-left text-xl"></i> Back to Map
                        </a>

                        <div className="w-full h-full overflow-hidden relative">
                            
                            {/* ‰ªÖÂú®Â§öÂõæÊó∂ÊòæÁ§∫ÁÆ≠Â§¥ */}
                            {activeLoc.imgs.length > 1 && (
                                <>
                                    <button onClick={(e) => { e.stopPropagation(); changeImage(-1); }} 
                                            className="absolute left-4 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-black/30 hover:bg-black/60 text-white flex items-center justify-center backdrop-blur-md z-30 transition border border-white/20 hover:scale-110">
                                        <i className="ph ph-caret-left text-2xl"></i>
                                    </button>
                                    <button onClick={(e) => { e.stopPropagation(); changeImage(1); }} 
                                            className="absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-black/30 hover:bg-black/60 text-white flex items-center justify-center backdrop-blur-md z-30 transition border border-white/20 hover:scale-110">
                                        <i className="ph ph-caret-right text-2xl"></i>
                                    </button>
                                    
                                    {/* ÊåáÁ§∫Âô® */}
                                    <div className="absolute bottom-24 left-1/2 -translate-x-1/2 flex gap-2 z-30">
                                        {activeLoc.imgs.map((_, i) => (
                                            <div key={i} className={`w-2 h-2 rounded-full transition-all ${i === imgIdx ? 'bg-white w-6' : 'bg-white/40'}`}></div>
                                        ))}
                                    </div>
                                </>
                            )}

                            <img 
                                key={`${activeId}-${imgIdx}`} 
                                src={activeLoc.imgs[imgIdx]} 
                                className="w-full h-full object-cover transition-all duration-500 transform scale-110 animate-[fadeIn_0.5s]"
                                style={{ 
                                    filter: `blur(${blurAmount}px) brightness(${0.5 + (focusVal/200)})`,
                                    transform: `scale(${1.1 - (focusVal/1000)})` 
                                }}
                                onError={(e) => e.target.src = 'https://placehold.co/1200x800/064e3b/34d399?text=' + activeLoc.title}
                            />
                            {view !== 'focus' && <div className="absolute inset-0 bg-green-500/10 mix-blend-overlay animate-pulse pointer-events-none"></div>}
                        </div>

                        {/* Áõ∏Êú∫ UI */}
                        <div className="absolute inset-0 pointer-events-none p-8 flex flex-col justify-between z-10">
                            <div className="flex justify-between items-start">
                                <div className="text-red-500 font-mono font-bold animate-pulse flex items-center gap-3 bg-black/40 px-3 py-1 rounded backdrop-blur-sm">
                                    <div className="w-3 h-3 bg-red-500 rounded-full shadow-[0_0_10px_red]"></div> REC
                                </div>
                                <div className="text-white/80 font-mono text-sm flex flex-col items-end gap-1">
                                    <span>ISO 200</span>
                                    <span className="text-green-400">AF-S</span>
                                </div>
                            </div>
                            
                            <div className={`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transition-all duration-300 ${view !== 'focus' ? 'w-full h-full border-4 border-green-500/50' : 'w-64 h-48 border-2 border-white/30'}`}>
                                {view === 'focus' ? (
                                    <>
                                        <div className="absolute top-0 left-0 w-4 h-4 border-t-2 border-l-2 border-white"></div>
                                        <div className="absolute top-0 right-0 w-4 h-4 border-t-2 border-r-2 border-white"></div>
                                        <div className="absolute bottom-0 left-0 w-4 h-4 border-b-2 border-l-2 border-white"></div>
                                        <div className="absolute bottom-0 right-0 w-4 h-4 border-b-2 border-r-2 border-white"></div>
                                        <div className="w-2 h-2 bg-white/50 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div>
                                    </>
                                ) : (
                                    <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-green-400 font-black tracking-widest text-3xl animate-ping opacity-50">LOCKED</div>
                                )}
                            </div>

                            <div className="flex justify-between items-end text-white/60 font-mono text-sm">
                                <div>{activeLoc.title.toUpperCase()}, NZ</div>
                                <div className={`${focusVal > 90 ? 'text-green-400 font-bold' : 'text-white'}`}>FOCUS: {focusVal}%</div>
                            </div>
                        </div>
                    </div>

                    {/* 2. Âè≥‰æßÔºöÊéßÂà∂Èù¢Êùø */}
                    <div className="flex-1 bg-slate-900/60 backdrop-blur-3xl border-l border-white/5 relative flex flex-col h-[60vh] md:h-auto overflow-hidden">
                        
                        {/* ÊôØÁÇπÈÄâÊã©Âô® */}
                        <div className="p-6 pb-2 grid grid-cols-2 gap-3 shrink-0">
                            {LOCATIONS.map(item => (
                                <button 
                                    key={item.id}
                                    onClick={() => switchLocation(item.id)}
                                    className={`loc-btn ${activeId === item.id ? 'active' : ''}`}
                                >
                                    <i className={`ph ${item.icon} text-xl`}></i>
                                    {item.title}
                                </button>
                            ))}
                        </div>

                        {/* ËøõÂ∫¶Êù° */}
                        <div className="flex justify-center gap-2 pt-2 pb-2 shrink-0">
                            {['focus', 'learn'].map((v, i) => (
                                <div key={v} className={`h-1.5 w-12 rounded-full transition-all ${view === v ? 'bg-green-400 shadow-[0_0_10px_#34d399]' : 'bg-slate-600'}`}></div>
                            ))}
                        </div>

                        <div className="flex-1 relative overflow-y-auto custom-scroll p-6 md:p-8">
                            <div className="min-h-full flex flex-col items-center justify-center">
                            
                                {/* --- Phase 1: Focus --- */}
                                {view === 'focus' && (
                                    <div className="w-full flex flex-col items-center fade-in">
                                        <h2 className="text-green-200 font-bold uppercase tracking-[0.2em] text-xs mb-4">Step 1: Identify</h2>
                                        <div className="bg-green-500/10 text-green-200 px-6 py-4 rounded-2xl border border-green-500/20 inline-block font-medium shadow-lg w-full max-w-sm text-center mb-10">
                                            <i className="ph ph-aperture mr-2 align-middle"></i> "Adjust focus to reveal the view."
                                        </div>

                                        <div className="w-full max-w-sm mb-8 relative group">
                                            <div className="flex justify-between text-xs text-slate-400 mb-3 font-mono tracking-widest">
                                                <span>BLUR</span><span>SHARP</span>
                                            </div>
                                            <input 
                                                type="range" min="0" max="100" value={focusVal} 
                                                onChange={(e) => {
                                                    const v = parseInt(e.target.value);
                                                    setFocusVal(v);
                                                    if(v > 90) handleFocusComplete();
                                                }}
                                                className="w-full h-2 rounded-lg appearance-none cursor-pointer bg-slate-700"
                                            />
                                        </div>
                                    </div>
                                )}

                                {/* --- Phase 2: Learn (Rich Content, No Spelling) --- */}
                                {view === 'learn' && (
                                    <div className="w-full fade-in flex flex-col items-center gap-6 pb-8">
                                        
                                        <div className="text-center">
                                            <span className="text-green-400 font-bold tracking-widest text-xs uppercase mb-2 block">Destination: {COMMON_INFO.country}</span>
                                            <h1 className="text-3xl md:text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-green-200 via-white to-blue-200 mb-2 drop-shadow-sm fun-font">
                                                {activeLoc.title}
                                            </h1>
                                            <button onClick={() => speak(activeLoc.title)} className="p-2 rounded-full text-green-400 hover:text-white transition">
                                                <i className="ph ph-speaker-high text-2xl"></i>
                                            </button>
                                        </div>

                                        {/* Card 1: Selected Location Info */}
                                        <div className="bg-gradient-to-b from-white/10 to-white/5 p-6 rounded-3xl border border-white/10 text-left shadow-2xl relative overflow-hidden w-full">
                                            <div className="absolute top-0 right-0 p-4 opacity-10"><i className={`ph ${activeLoc.icon} text-8xl text-green-200`}></i></div>
                                            <h3 className="text-green-400 font-bold uppercase tracking-widest text-xs mb-2">Featured Spot</h3>
                                            <p className="serif text-lg text-green-50 mb-3 leading-relaxed relative z-10">"{activeLoc.desc_en}"</p>
                                            <p className="text-slate-400 text-sm mb-4 leading-relaxed">{activeLoc.desc_cn}</p>
                                            <div className="text-right">
                                                <button onClick={() => speak(activeLoc.desc_en)} className="px-4 py-2 rounded-full bg-slate-700 hover:bg-slate-600 flex items-center justify-center text-white shadow-lg transition gap-2 ml-auto font-bold text-sm">
                                                    <i className="ph ph-speaker-high"></i> Listen
                                                </button>
                                            </div>
                                        </div>

                                        {/* Card 2: Fun Facts (Fixed) */}
                                        <div className="bg-gradient-to-br from-blue-900/40 to-slate-900/40 p-6 rounded-3xl border border-blue-500/30 text-left shadow-2xl relative overflow-hidden w-full group">
                                            <div className="absolute -bottom-4 -right-4 p-4 opacity-20 text-blue-500"><i className="ph ph-bird text-8xl"></i></div>
                                            <h3 className="text-blue-400 font-bold uppercase tracking-widest text-xs mb-2 flex items-center gap-2">
                                                <i className="ph ph-lightbulb-filament"></i> {COMMON_INFO.fun_title}
                                            </h3>
                                            <p className="serif text-lg text-white mb-3 leading-relaxed relative z-10 font-medium">"{COMMON_INFO.fun_en}"</p>
                                            <p className="text-slate-400 text-sm mb-4 leading-relaxed">{COMMON_INFO.fun_cn}</p>
                                            <div className="text-right relative z-10">
                                                <button onClick={() => speak(COMMON_INFO.fun_en)} className="px-5 py-2 rounded-full bg-blue-600 hover:bg-blue-500 flex items-center justify-center text-white shadow-lg shadow-blue-900/50 transition gap-2 ml-auto font-bold text-sm">
                                                    <i className="ph ph-speaker-high"></i> Learn Fact
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>