<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore: Arctic Ocean (Pro)</title>
    
    <script src="https://cdn.staticfile.net/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.staticfile.net/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.staticfile.net/babel-standalone/7.22.17/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/microsoft-cognitiveservices-speech-sdk/distrib/browser/microsoft.cognitiveservices.speech.sdk.bundle-min.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&family=Fredoka:wght@500;600&family=Noto+Serif:ital,wght@0,500;1,500&display=swap" rel="stylesheet">

    <style>
        /* å…¨å±€è®¾ç½® */
        * { -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: 'Outfit', sans-serif; 
            background-color: #0f172a;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .serif { font-family: 'Noto Serif', serif; }
        .fun-font { font-family: 'Fredoka', sans-serif; }

        /* å…¨å±è§†é¢‘èƒŒæ™¯ */
        .video-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; z-index: -1;
            /* è§†é¢‘æœªåŠ è½½æ—¶çš„å¤‡ç”¨æ¸å˜ */
            background: linear-gradient(180deg, #020617 0%, #172554 50%, #1e1b4b 100%);
        }
        .video-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.4); /* é®ç½©å±‚ï¼Œè®©æ–‡å­—æ›´æ¸…æ™° */
            z-index: -1;
            backdrop-filter: blur(4px);
        }

        /* ç»ç’ƒé¢æ¿ */
        .glass-panel { 
            background: rgba(15, 23, 42, 0.6); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1); 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); 
            border-radius: 2rem;
        }

        /* åŠ¨ç”» */
        .fade-in { animation: fadeIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        .letter-pop { animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes pop { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

        /* è¿”å›æŒ‰é’® */
        .nav-back { 
            position: fixed; top: 20px; left: 20px; z-index: 50; 
            background: rgba(0,0,0,0.5); color: white; 
            padding: 10px 20px; border-radius: 99px; text-decoration: none; 
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); 
            font-weight: 600; font-size: 1rem;
            transition: all 0.2s; display: flex; align-items: center; gap: 8px;
        }
        .nav-back:hover { background: rgba(0,0,0,0.7); transform: scale(1.05); }
    </style>
</head>
<body>
    
    <video autoplay muted loop playsinline class="video-bg">
        <source src="aurora_effect.mp4" type="video/mp4">
    </video>
    <div class="video-overlay"></div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // ğŸ”¹ Azure è¯­éŸ³é…ç½®
        // ==========================================
        const azureKey = "DKRXk8ueSfo5NdIOMqFRTCAfpeGDezJ3Snf5K8gGgtyqxiWdugLzJQQJ99BLACHYHv6XJ3w3AAAYACOGUYP9";
        const azureRegion = "eastus2"; 
        
        let currentSynthesizer = null;

        const speak = (text, onComplete) => {
            if (currentSynthesizer) { currentSynthesizer.close(); currentSynthesizer = null; }
            if (!text) return;
            
            try {
                const speechConfig = SpeechSDK.SpeechConfig.fromSubscription(azureKey, azureRegion);
                speechConfig.speechSynthesisVoiceName = "en-US-JennyNeural"; 
                const audioConfig = SpeechSDK.AudioConfig.fromDefaultSpeakerOutput();
                const synthesizer = new SpeechSDK.SpeechSynthesizer(speechConfig, audioConfig);
                currentSynthesizer = synthesizer;
                
                synthesizer.speakTextAsync(text, result => {
                    synthesizer.close(); currentSynthesizer = null;
                    if(onComplete) onComplete();
                }, err => { console.error(err); synthesizer.close(); currentSynthesizer = null; });
            } catch (e) { console.error("Azure Error", e); }
        };

        // ==========================================
        // ğŸ”¹ é¡µé¢ç»„ä»¶
        // ==========================================

        const App = () => {
            const [phase, setPhase] = useState('question'); // question -> spelling -> sentence
            const [lettersRevealed, setLettersRevealed] = useState(0);
            const targetWord = "Aurora Borealis";
            const targetChars = targetWord.split('');

            // 1. Question Phase
            const handleQuestionClick = () => {
                speak("It is the Aurora Borealis.", () => {
                    setTimeout(() => setPhase('spelling'), 500);
                });
            };

            // 2. Spelling Phase
            const handleRevealNext = () => {
                // Find next non-space letter index
                let nextIndex = lettersRevealed;
                while (nextIndex < targetChars.length && targetChars[nextIndex] === ' ') {
                    nextIndex++;
                }
                
                if (nextIndex < targetChars.length) {
                    setLettersRevealed(nextIndex + 1);
                    speak(targetChars[nextIndex]); // è¯»å‡ºå­—æ¯
                } else {
                    // All revealed
                    speak("Aurora Borealis", () => {
                        setPhase('sentence');
                    });
                }
            };

            // Helper: Check if fully revealed (ignoring spaces)
            const isFullyRevealed = () => {
                let lastCharIndex = targetChars.length; 
                // find simple check logic
                return lettersRevealed >= targetChars.length;
            };

            // Effect: Auto transition if we hit a space during reveal
            useEffect(() => {
                if (phase === 'spelling' && lettersRevealed < targetChars.length) {
                    if (targetChars[lettersRevealed] === ' ') {
                        setLettersRevealed(l => l + 1);
                    }
                }
                if (phase === 'spelling' && lettersRevealed >= targetChars.length) {
                     // Wait a bit then finish
                     setTimeout(() => {
                         // Button changes state, user clicks done or auto?
                         // Let's make user click "Done" or auto transition
                     }, 500);
                }
            }, [lettersRevealed, phase]);


            return (
                <div className="w-full min-h-screen flex flex-col items-center justify-center p-6 relative">
                    
                    {/* è¿”å›æŒ‰é’® */}
                    <a href="FU303Main.html" className="nav-back">
                        <i className="ph ph-arrow-u-up-left text-xl"></i> Back to Map
                    </a>

                    {/* æ ‡é¢˜ */}
                    <div className="absolute top-20 text-center fade-in">
                        <span className="bg-blue-500/20 text-blue-200 px-4 py-1 rounded-full text-sm font-bold uppercase tracking-widest border border-blue-400/30">
                            Geography & Science
                        </span>
                        <h1 className="text-5xl md:text-7xl font-black mt-4 drop-shadow-[0_0_20px_rgba(56,189,248,0.5)] text-transparent bg-clip-text bg-gradient-to-r from-blue-200 via-white to-teal-200">
                            Arctic Ocean
                        </h1>
                    </div>

                    {/* äº’åŠ¨åŒºåŸŸ */}
                    <div className="w-full max-w-4xl mt-20">
                        
                        {/* Phase 1: Teacher Question */}
                        {phase === 'question' && (
                            <div className="flex justify-center fade-in">
                                <button onClick={handleQuestionClick} 
                                        className="group relative bg-white/10 hover:bg-white/20 backdrop-blur-xl border border-white/20 p-8 rounded-3xl text-center max-w-xl shadow-2xl transition-all hover:scale-105">
                                    <div className="absolute -top-6 -left-6 bg-yellow-400 text-slate-900 w-16 h-16 rounded-full flex items-center justify-center font-bold text-2xl shadow-lg group-hover:scale-110 transition">
                                        <i className="ph ph-question"></i>
                                    </div>
                                    <h2 className="text-2xl md:text-3xl font-bold mb-2">Teacher asks:</h2>
                                    <p className="text-xl text-blue-100 font-light">"What weather phenomenon is this?"</p>
                                    <div className="mt-6 flex justify-center">
                                        <span className="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-full font-bold shadow-lg flex items-center gap-2 transition">
                                            <i className="ph ph-chat-circle-text text-xl"></i> Answer
                                        </span>
                                    </div>
                                </button>
                            </div>
                        )}

                        {/* Phase 2: Spelling */}
                        {(phase === 'spelling' || phase === 'sentence') && (
                            <div className="glass-panel p-8 md:p-12 fade-in flex flex-col items-center">
                                <h3 className="text-blue-300 font-bold uppercase tracking-widest mb-8">Spell the Word</h3>
                                
                                <div className="flex flex-wrap justify-center gap-2 md:gap-4 mb-10">
                                    {targetChars.map((char, i) => (
                                        <div key={i} 
                                             className={`w-10 h-14 md:w-14 md:h-20 rounded-xl flex items-center justify-center text-3xl md:text-4xl font-bold fun-font transition-all duration-300
                                                 ${char === ' ' ? 'w-4 md:w-8 bg-transparent shadow-none' : 
                                                   i < lettersRevealed ? 'bg-blue-500 text-white shadow-lg shadow-blue-500/40 scale-100 letter-pop' : 
                                                   'bg-white/10 text-transparent border-2 border-white/20'}`}>
                                            {char}
                                        </div>
                                    ))}
                                </div>

                                {phase === 'spelling' && (
                                    <div className="flex gap-4">
                                        <button onClick={() => speak("Aurora Borealis")} className="w-14 h-14 rounded-full bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center transition shadow-lg">
                                            <i className="ph ph-speaker-high text-2xl"></i>
                                        </button>
                                        
                                        {!isFullyRevealed() ? (
                                            <button onClick={handleRevealNext} className="px-8 py-3 bg-green-500 hover:bg-green-400 text-white rounded-full font-bold text-lg shadow-lg shadow-green-500/30 transition active:scale-95 flex items-center gap-2">
                                                Reveal Letter <i className="ph ph-arrow-right"></i>
                                            </button>
                                        ) : (
                                            <button onClick={() => { setPhase('sentence'); speak("We were lucky to see the Aurora Borealis dancing in the sky."); }} 
                                                    className="px-8 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-full font-bold text-lg shadow-lg shadow-blue-500/30 transition animate-bounce">
                                                Show Sentence <i className="ph ph-check"></i>
                                            </button>
                                        )}
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Phase 3: Sentence */}
                        {phase === 'sentence' && (
                            <div className="mt-8 glass-panel p-8 border-l-8 border-teal-400 fade-in relative overflow-hidden group">
                                <div className="absolute top-0 right-0 p-3 opacity-10 group-hover:opacity-20 transition"><i className="ph ph-quotes text-8xl"></i></div>
                                
                                <div className="relative z-10 text-center">
                                    <p className="serif text-2xl md:text-4xl leading-relaxed text-white mb-4 drop-shadow-md">
                                        "We were lucky to see the <span className="text-teal-300 font-bold border-b-2 border-teal-300/50">Aurora Borealis</span> dancing in the sky."
                                    </p>
                                    <p className="text-slate-400 text-lg mb-6">æˆ‘ä»¬å¾ˆå¹¸è¿èƒ½çœ‹åˆ°åŒ—æå…‰åœ¨å¤©ç©ºä¸­èˆåŠ¨ã€‚</p>
                                    
                                    <div className="flex justify-center gap-4">
                                        <button onClick={() => speak("We were lucky to see the Aurora Borealis dancing in the sky.")} 
                                                className="bg-white/10 hover:bg-white/20 border border-white/20 text-white px-6 py-3 rounded-full font-bold flex items-center gap-2 transition">
                                            <i className="ph ph-speaker-high text-xl"></i> Listen Again
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>